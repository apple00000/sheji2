{"version":3,"sources":["assets/framework/http/HttpProtocol.ts"],"names":[],"mappings":";;;;AAAA,oBAAoB;AACpB,iFAAiF;AACjF,yFAAyF;AACzF,mBAAmB;AACnB,2FAA2F;AAC3F,mGAAmG;AACnG,8BAA8B;AAC9B,2FAA2F;AAC3F,mGAAmG;;AAEnG;IAAA;QACI,QAAG,GAAU,IAAI,CAAC;QAClB,YAAO,GAAU,EAAE,CAAC;QACpB,aAAQ,GAAU,IAAI,CAAC;IAgD3B,CAAC;IA9CG,wCAAiB,GAAjB;QACI,OAAO,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC;IAChC,CAAC;IAED,sCAAe,GAAf;QACI,OAAO,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC;IAC9B,CAAC;IAED,yCAAkB,GAAlB;QACI,OAAO,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC;IACjC,CAAC;IAED,6BAAM,GAAN;QACI,OAAO,CAAC,GAAG,CAAC,eAAe,GAAC,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;QACpD,IAAI,MAAM,GAAG,IAAI,CAAC;QAClB,IAAG,OAAO,QAAQ,IAAI,UAAU,EAAE;YAC9B,IAAI,IAAI,GAAG,IAAI,QAAQ,EAAE,CAAC;YAC1B,KAAI,IAAI,IAAI,IAAI,IAAI,CAAC,OAAO,EAAE;gBAC1B,IAAI,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,UAAU,EAAC;oBACxC,IAAI,CAAC,MAAM,CAAC,IAAI,EAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC;iBACxC;aACJ;YACD,MAAM,GAAG,IAAI,CAAC;SACjB;aAAK;YACF,qBAAqB;YACrB,IAAI,GAAG,GAAG,EAAE,CAAC;YACb,IAAI,CAAC,GAAG,CAAC,CAAC;YACV,KAAI,IAAI,IAAI,IAAI,IAAI,CAAC,OAAO,EAAE;gBAC1B,IAAI,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,UAAU,EAAC;oBACxC,GAAG,CAAC,CAAC,CAAC,GAAG,kBAAkB,CAAC,IAAI,CAAC,GAAG,GAAG,GAAG,kBAAkB,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC;oBACjF,CAAC,EAAE,CAAC;iBACP;aACJ;YACD,MAAM,GAAG,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;SAC1B;QAED,OAAO,MAAM,CAAC;IAClB,CAAC;IAED,6BAAM,GAAN,UAAO,IAAQ;QACX,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QACjC,OAAO,CAAC,GAAG,CAAC,eAAe,GAAC,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;QAC5C,IAAI,IAAI,CAAC,QAAQ,CAAC,MAAM,IAAI,CAAC,EAAC;YAC1B,MAAM,IAAI,CAAC,QAAQ,CAAC;SACvB;IACL,CAAC;IACL,mBAAC;AAAD,CAnDA,AAmDC,IAAA","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nexport default class HttpProtocol {\r\n    uri:string = null;\r\n    request:object = {};\r\n    response:object = null;\r\n\r\n    getResponseStatus():number{\r\n        return this.response.status;\r\n    }\r\n\r\n    getResponseData<T>():T{\r\n        return this.response.data;\r\n    }\r\n\r\n    getResponseMessage():string{\r\n        return this.response.message;\r\n    }\r\n\r\n    encode(){\r\n        console.log(\">>>>发发发发发发===\"+this.uri, this.request);\r\n        let result = null;\r\n        if(typeof FormData == \"function\") {\r\n            let data = new FormData();\r\n            for(let attr in this.request) {\r\n                if (typeof this.request[attr] != \"function\"){\r\n                    data.append(attr,this.request[attr]);\r\n                }\r\n            }\r\n            result = data;\r\n        }else {\r\n            // 不支持FormData的浏览器的处理\r\n            let arr = [];\r\n            let i = 0;\r\n            for(let attr in this.request) {\r\n                if (typeof this.request[attr] != \"function\"){\r\n                    arr[i] = encodeURIComponent(attr) + \"=\" + encodeURIComponent(this.request[attr]);\r\n                    i++;\r\n                }\r\n            }\r\n            result = arr.join(\"&\");\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    decode(data:any){\r\n        this.response = JSON.parse(data);\r\n        console.log(\"<<<<收收收收收收===\"+this.uri, data);\r\n        if (this.response.status != 0){\r\n            throw this.response;\r\n        }\r\n    }\r\n}\r\n"]}