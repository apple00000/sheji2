{"version":3,"sources":["assets/framework/component/CDTimer.ts"],"names":[],"mappings":";;;;;AACM,IAAA,KAA8C,EAAE,CAAC,UAAU,EAA1D,OAAO,aAAA,EAAE,QAAQ,cAAA,EAAE,IAAI,UAAA,EAAE,gBAAgB,sBAAiB,CAAC;AAKlE;IAAqC,2BAAY;IAAjD;QAAA,qEA+CC;QA7CG,UAAI,GAAG,KAAK,CAAC;QAGb,QAAE,GAAG,CAAC,CAAC;QAGP,WAAK,GAAG,KAAK,CAAC;QAGd,wBAAkB,GAA+B,EAAE,CAAC;QAGpD,uBAAiB,GAA+B,EAAE,CAAC;QAG3C,cAAQ,GAAG,CAAC,CAAC;;IA8BzB,CAAC;IA5BG,sBAAI,4BAAO;aAAX;YACI,OAAO,IAAI,CAAC,QAAQ,CAAC;QACzB,CAAC;;;OAAA;IAED,yBAAO,GAAP;QACI,OAAO,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC;IAClC,CAAC;IAED,uBAAK,GAAL;QACI,IAAI,CAAC,QAAQ,GAAG,CAAC,CAAC;IACtB,CAAC;IAED,wBAAM,GAAN,UAAQ,EAAE;QACN,IAAI,IAAI,CAAC,KAAK;YAAC,OAAO;QACtB,IAAI,IAAI,CAAC,EAAE,GAAG,CAAC,IAAI,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,EAAE,EAAC;YACvC,IAAI,CAAC,QAAQ,IAAI,EAAE,CAAC;YACpB,IAAI,QAAQ,GAAG,IAAI,CAAC,QAAQ,GAAC,IAAI,CAAC,EAAE,CAAC;YACrC,EAAE,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,IAAI,CAAC,kBAAkB,EAAE,QAAQ,CAAC,CAAC;YACxE,IAAI,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,EAAE,EAAC;gBACzB,EAAE,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,IAAI,CAAC,iBAAiB,EAAE,QAAQ,CAAC,CAAC;gBACvE,IAAI,IAAI,CAAC,IAAI,EAAC;oBACV,IAAI,CAAC,OAAO,EAAE,CAAC;iBAClB;qBAAM;oBACH,IAAI,CAAC,KAAK,EAAE,CAAC;iBAChB;aACJ;SACJ;IACL,CAAC;IA5CD;QADC,QAAQ,CAAC,EAAC,WAAW,EAAC,OAAO,EAAE,QAAQ,EAAC,gBAAgB,EAAC,CAAC;yCAC9C;IAGb;QADC,QAAQ,CAAC,EAAC,WAAW,EAAC,QAAQ,EAAC,CAAC;uCAC1B;IAGP;QADC,QAAQ,CAAC,EAAC,WAAW,EAAC,MAAM,EAAC,CAAC;0CACjB;IAGd;QADC,QAAQ,CAAC,EAAC,IAAI,EAAC,EAAE,CAAC,SAAS,CAAC,YAAY,EAAE,WAAW,EAAC,MAAM,EAAE,QAAQ,EAAC,aAAa,EAAC,CAAC;uDACnC;IAGpD;QADC,QAAQ,CAAC,EAAC,IAAI,EAAC,EAAE,CAAC,SAAS,CAAC,YAAY,EAAE,WAAW,EAAC,MAAM,EAAE,QAAQ,EAAC,aAAa,EAAC,CAAC;sDACpC;IAdlC,OAAO;QAH3B,OAAO;QACP,gBAAgB;QAChB,IAAI,CAAC,aAAa,CAAC;OACC,OAAO,CA+C3B;IAAD,cAAC;CA/CD,AA+CC,CA/CoC,EAAE,CAAC,SAAS,GA+ChD;kBA/CoB,OAAO","file":"","sourceRoot":"/","sourcesContent":["\r\nconst {ccclass, property, menu, disallowMultiple} = cc._decorator;\r\n\r\n@ccclass\r\n@disallowMultiple\r\n@menu(\"自定义/CDTimer\")\r\nexport default class CDTimer extends cc.Component {\r\n    @property({displayName:\"是否一次性\", textTips:\"选是则在倒计时结束会销毁自己\"})\r\n    once = false;\r\n\r\n    @property({displayName:\"倒计时(秒)\"})\r\n    cd = 0;\r\n\r\n    @property({displayName:\"暂停开关\"})\r\n    pause = false;\r\n\r\n    @property({type:cc.Component.EventHandler, displayName:\"进度事件\", textTips:\"每一帧都会收到进度信息\"})\r\n    frameEventHandlers:[cc.Component.EventHandler] = [];\r\n\r\n    @property({type:cc.Component.EventHandler, displayName:\"归零事件\", textTips:\"CD归零时会收到此消息\"})\r\n    zeroEventHandlers:[cc.Component.EventHandler] = [];\r\n\r\n\r\n    private _curTime = 0;\r\n\r\n    get curTime(): number {\r\n        return this._curTime;\r\n    }\r\n\r\n    cdDelta():number{\r\n        return this.cd - this.curTime;\r\n    }\r\n\r\n    reset(){\r\n        this._curTime = 0;\r\n    }\r\n\r\n    update (dt) {\r\n        if (this.pause)return;\r\n        if (this.cd > 0 && this._curTime < this.cd){\r\n            this._curTime += dt;\r\n            let progress = this._curTime/this.cd;\r\n            cc.Component.EventHandler.emitEvents(this.frameEventHandlers, progress);\r\n            if (this._curTime >= this.cd){\r\n                cc.Component.EventHandler.emitEvents(this.zeroEventHandlers, progress);\r\n                if (this.once){\r\n                    this.destroy();\r\n                } else {\r\n                    this.reset();\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n"]}