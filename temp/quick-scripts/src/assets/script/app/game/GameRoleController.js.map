{"version":3,"sources":["assets/script/app/game/GameRoleController.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\n\r\nimport BulletEmitterShanDianQiu from \"../entities/bulletEmitter/BulletEmitterShanDianQiu\";\r\nimport BulletEmitterHuoJianTong from \"../entities/bulletEmitter/BulletEmitterHuoJianTong\";\r\nimport BulletEmitterShouQiang from \"../entities/bulletEmitter/BulletEmitterShouQiang\";\r\nimport BulletEmitterSanDanQiang from \"../entities/bulletEmitter/BulletEmitterSanDanQiang\";\r\nimport Role, {SpeedType} from \"../entities/role/Role\";\r\nimport Actions from \"../../../framework/actions/Actions\";\r\nimport BulletEmitterJiGuang from \"../entities/bulletEmitter/BulletEmitterJiGuang\";\r\nimport BulletEmitterLiZiPao from \"../entities/bulletEmitter/BulletEmitterLiZiPao\";\r\nimport BulletEmitterJiaTeLin from \"../entities/bulletEmitter/BulletEmitterJiaTeLin\";\r\nimport BulletEmitterJuJiQiang from \"../entities/bulletEmitter/BulletEmitterJuJiQiang\";\r\nimport BulletEmitterHuoYan from \"../entities/bulletEmitter/BulletEmitterHuoYan\";\r\nimport AABBRegion from \"../../quad-tree/AABBRegion\";\r\nimport EnemyAABB from \"../entities/enemy/EnemyAABB\";\r\nimport BulletEmitter from \"../entities/bulletEmitter/BulletEmitter\";\r\nimport BulletEmitterPenZi from \"../entities/bulletEmitter/BulletEmitterPenZi\";\r\nimport {GameProxy} from \"./GameProxy\";\r\nimport Enemy from \"../entities/enemy/Enemy\";\r\nimport BulletOfFangHuDun from \"../entities/bullet/BulletOfFangHuDun\";\r\nimport PropBase from \"../entities/prop/PropBase\";\r\nimport PropStateController from \"../entities/prop/PropStateController\";\r\nimport {Music} from \"../../../framework/audio/Music\";\r\nimport {World} from \"../info/World\";\r\nimport {ExcelConfig} from \"../../../framework/config/ExcelConfig\";\r\nimport {ExcelTableNames} from \"../config/ExcelTableNames\";\r\nimport GameController from \"./GameController\";\r\nimport {ext} from \"../../../framework/extend/Extend\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\nexport enum JoystickType {\r\n    FIXED,\r\n    FOLLOW,\r\n}\r\n\r\nexport enum DirectionType{\r\n    FOUR = 4,\r\n    EIGHT = 8,\r\n    ALL = 0,\r\n}\r\n\r\nconst RING_OPACITY = 80;\r\n\r\nconst EmitterSfxVolumes = [0.33, 0.8, 0.8, 0.45, 1, 2, 1, 0.6, 1, 2, 1, 1, 1];\r\n\r\n@ccclass\r\nexport default class GameRoleController extends cc.Component {\r\n\r\n    @property(cc.Node)\r\n    guideNode:cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    bulletStrikeLayer:cc.Node = null;\r\n\r\n    @property(cc.Prefab)\r\n    propStatePrefab:cc.Prefab = null;\r\n\r\n    @property(cc.Node)\r\n    propStateNode:cc.Node = null;\r\n    @property(cc.Node)\r\n    takePropLayer:cc.Node = null;\r\n    @property(sp.Skeleton)\r\n    beAttackSke:sp.Skeleton = null;\r\n\r\n    @property(sp.Skeleton)\r\n    weaponSke:sp.Skeleton = null;\r\n\r\n    @property(cc.Label)\r\n    payloadLabel:cc.Label = null;\r\n\r\n    @property(cc.Node)\r\n    payloadBars:[cc.Node] = [];\r\n\r\n    @property(cc.ProgressBar)\r\n    hpProgressBar:cc.ProgressBar = null;\r\n\r\n    @property(cc.Node)\r\n    hpBarNode:cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    bgLayer:cc.Node = null;\r\n\r\n    @property({type:cc.Node, tooltip:\"摇杆操纵点\"})\r\n    dot:cc.Node = null;\r\n\r\n    @property({type:cc.Node, tooltip:\"摇杆背景节点\"})\r\n    ring:cc.Node = null;\r\n\r\n    @property({type:cc.Enum(JoystickType), tooltip:\"触摸类型\"})\r\n    joystickType:JoystickType = JoystickType.FIXED;\r\n\r\n    @property({type:cc.Enum(DirectionType), tooltip:\"方向类型\"})\r\n    directionType:DirectionType = DirectionType.ALL;\r\n\r\n    private _radius = 0;\r\n\r\n\r\n    private _takeProps:Array<cc.Node> = [];\r\n\r\n    private genTakePropNode():cc.Node{\r\n        let prefabPath = 'prefab/entities/prop/takeProp';\r\n        let entityPrefab = cc.loader.getRes(prefabPath, cc.Prefab);\r\n        let node = cc.instantiate(entityPrefab);\r\n        node.active = false;\r\n        this.takePropLayer.addChild(node);\r\n        this._takeProps.push(node);\r\n        return node;\r\n    }\r\n\r\n    private getInactiveTakePropNode():cc.Node{\r\n        let result:cc.Node = this._takeProps.find(value => value.active == false);\r\n        if (typeof result == \"undefined\"){\r\n            result = this.genTakePropNode();\r\n        }\r\n        return result;\r\n    }\r\n\r\n    @property(Role)\r\n    role:Role = null;\r\n\r\n    @property(BulletOfFangHuDun)\r\n    impenetrableDefence:BulletOfFangHuDun = null;\r\n\r\n    maxHp = 1000;\r\n\r\n    private _hp = 0;\r\n\r\n\r\n    get hp(): number {\r\n        return this._hp;\r\n    }\r\n\r\n    set hp(value: number) {\r\n        if (this.impenetrableDefence.node.active){\r\n            //减速\r\n            this.impenetrableDefence.strike(null, null);\r\n            return;\r\n        }\r\n        if (this._hp <= 0)return;\r\n        let damage = this._hp - value;\r\n        window['GameLabelsController'] .fly(`-${ext.shortFormat(damage)}`, this.role.node.position.add(cc.v2(0, this.role.spaceCircleCollider.radius)));\r\n        this._hp = value;\r\n        if (value <= 0){\r\n            GameProxy.emit(GameProxy.Event.KillRole);\r\n        }\r\n        this.updateHpProgress();\r\n        this.beAttackSke.node.active = true;\r\n        this.beAttackSke.setAnimation(0, \"crazy\", false);\r\n        Music.playSFX(\"sound/msc_rol001\");\r\n        this.hpBarNode.color = cc.Color.RED;\r\n        this.role.spriteNode.color = cc.Color.RED;\r\n        let action = cc.sequence(cc.delayTime(0.2), cc.callFunc(()=>{\r\n            this.hpBarNode.color = cc.Color.GREEN;\r\n            this.role.spriteNode.color = cc.Color.WHITE;\r\n        }));\r\n        action.setTag(901);\r\n        this.role.node.stopActionByTag(901);\r\n        this.role.node.runAction(action);\r\n    }\r\n\r\n    huiXue(add:number){\r\n        this._hp += add;\r\n        if (this._hp > this.maxHp){\r\n            this._hp = this.maxHp;\r\n        }\r\n        this.updateHpProgress();\r\n    }\r\n\r\n    updateHpProgress(){\r\n        this.hpProgressBar.progress = this._hp / this.maxHp;\r\n    }\r\n\r\n    private _bulletEmitter:number = 0;\r\n\r\n\r\n    get bulletEmitter(): number {\r\n        return this._bulletEmitter;\r\n    }\r\n\r\n    set bulletEmitter(value: number) {\r\n        if (this._bulletEmitter != 0){\r\n            Music.playSFX(\"sound/msc_rol003\");\r\n        }\r\n        if (this._bulletEmitter != value){\r\n            this._bulletEmitter = value;\r\n            let gameBulletsController = window['GameBulletsController'];\r\n            let bulletEmitter:BulletEmitter = null;\r\n            switch (this._bulletEmitter){\r\n                case BulletEmitter.TYPES.ShouQiang:\r\n                    bulletEmitter = new BulletEmitterShouQiang(gameBulletsController);\r\n                    break;\r\n                case BulletEmitter.TYPES.PenZi:\r\n                    bulletEmitter = new BulletEmitterPenZi(gameBulletsController);\r\n                    break;\r\n                case BulletEmitter.TYPES.JiaTeLin:\r\n                    bulletEmitter = new BulletEmitterJiaTeLin(gameBulletsController);\r\n                    break;\r\n                case BulletEmitter.TYPES.SanDanQiang:\r\n                    bulletEmitter = new BulletEmitterSanDanQiang(gameBulletsController);\r\n                    break;\r\n                case BulletEmitter.TYPES.JuJiQiang:\r\n                    bulletEmitter = new BulletEmitterJuJiQiang(gameBulletsController);\r\n                    break;\r\n                case BulletEmitter.TYPES.LiZiPao:\r\n                    bulletEmitter = new BulletEmitterLiZiPao(gameBulletsController);\r\n                    break;\r\n                case BulletEmitter.TYPES.HuoJianTong:\r\n                    bulletEmitter = new BulletEmitterHuoJianTong(gameBulletsController);\r\n                    break;\r\n                case BulletEmitter.TYPES.ShanDianQiu:\r\n                    bulletEmitter = new BulletEmitterShanDianQiu(gameBulletsController);\r\n                    break;\r\n                case BulletEmitter.TYPES.JiGuang:\r\n                    bulletEmitter = new BulletEmitterJiGuang(gameBulletsController);\r\n                    break;\r\n                case BulletEmitter.TYPES.HuoYan:\r\n                    bulletEmitter = new BulletEmitterHuoYan(gameBulletsController);\r\n                    break;\r\n            }\r\n            this.bulletEmitterDelegate = bulletEmitter;\r\n            bulletEmitter.init(this._bulletEmitter);\r\n            // this.weaponSke.node.scale = 0;\r\n            // this.weaponSke.node.runAction(cc.scaleTo(0.35, 0.55).easing(cc.easeBackOut()));\r\n            this.weaponSke.setSkin((\"000\"+this._bulletEmitter).substr(-3));\r\n            this.weaponSke.setAnimation(0, \"gun_002\", false);\r\n        }\r\n    }\r\n\r\n    private _bulletEmitterDelegate:BulletEmitter = null;\r\n\r\n\r\n    get bulletEmitterDelegate(): BulletEmitter {\r\n        return this._bulletEmitterDelegate;\r\n    }\r\n\r\n    set bulletEmitterDelegate(value: BulletEmitter) {\r\n        if (this._bulletEmitterDelegate){\r\n            this._bulletEmitterDelegate.onExit();\r\n        }\r\n        this._bulletEmitterDelegate = value;\r\n        this._bulletEmitterDelegate.onEnter();\r\n    }\r\n\r\n\r\n    private _touchId = null;\r\n    private _bMove = false;\r\n    private _dir = cc.v2();\r\n\r\n\r\n    set touchId(value: any) {\r\n        this._touchId = value;\r\n        // if (this._touchId == null){\r\n        //     GameProxy.slowGame = true;\r\n        // } else {\r\n        //     GameProxy.slowGame = false;\r\n        // }\r\n    }\r\n\r\n    private _fireCD = 0;\r\n\r\n    private _bgBounds = cc.rect();\r\n    private _roleBounds = cc.rect();\r\n\r\n\r\n    get dir(): cc.Vec2 {\r\n        return this._dir;\r\n    }\r\n\r\n    get bMove(): boolean {\r\n        return this._bMove;\r\n    }\r\n\r\n    onLoad () {\r\n        this._radius = this.ring.width/2;\r\n        if (this.joystickType == JoystickType.FOLLOW) {\r\n            this.ring.opacity = 0;\r\n            this.dot.opacity = 0;\r\n        }\r\n        this.role.node.on(cc.Node.EventType.POSITION_CHANGED, this.onRolePositionChanged, this);\r\n        this.node.on(GameProxy.Event.PauseGame, this.onPauseGame, this);\r\n        this.node.on(GameProxy.Event.InitGame, this.onInitGame, this);\r\n        this.node.on(GameProxy.Event.StartGame, this.onStartGame, this);\r\n        this.node.on(GameProxy.Event.ReliveGame, this.onReliveGame, this);\r\n        this.node.on(GameProxy.Event.UpdateBulletCount, this.onUpdateBulletCount, this);\r\n        this.node.on(GameProxy.Event.PropTrigger, this.onPropTrigger, this);\r\n        this.node.on(GameProxy.Event.PropCDZero, this.onPropCDZero, this);\r\n        this.beAttackSke.setCompleteListener((trackEntry, loopCount) => {\r\n            let name = trackEntry.animation ? trackEntry.animation.name : '';\r\n            this.beAttackSke.node.active = false;\r\n        });\r\n        this.beAttackSke.node.active = false;\r\n        this.beAttackSke.node.scaleY = cc.view.getVisibleSize().height/1334;\r\n        this.weaponSke.setCompleteListener((trackEntry, loopCount) =>{\r\n            let name = trackEntry.animation ? trackEntry.animation.name : '';\r\n            if (name == 'gun_002'){\r\n                this.weaponSke.setAnimation(0, \"gun\", false);\r\n            }\r\n        });\r\n        window['GameRoleController'] = this;\r\n    }\r\n\r\n    onUpdateBulletCount(){\r\n        let str = `x${this._bulletEmitterDelegate.bulletCount}`;\r\n        if (this._bulletEmitter == 1){\r\n            str = '∞';\r\n        }\r\n        this.payloadLabel.string = str;\r\n        let num = this.payloadBars.length;\r\n        if (this._bulletEmitterDelegate.payload > 0){\r\n            num = Math.ceil(this._bulletEmitterDelegate.bulletCount/this._bulletEmitterDelegate.payload*this.payloadBars.length);\r\n        }\r\n        this.payloadBars.forEach((value, index) => value.active = index < num);\r\n    }\r\n\r\n    onPauseGame(pause:boolean){\r\n        if (pause){\r\n            this.touchId = null;\r\n            this._bMove = false;\r\n            this.dot.setPosition(this.ring.getPosition());\r\n            if (this.joystickType == JoystickType.FOLLOW) {\r\n                this.ring.opacity = 0;\r\n                this.dot.opacity = 0;\r\n            }\r\n        }\r\n    }\r\n\r\n    onInitGame(){\r\n        this.maxHp = this._hp = ExcelConfig.getExcelTable(ExcelTableNames.WeaponUp)[World.Storage.HpLv-1]['life'];\r\n        this.updateHpProgress();\r\n        this.setImpenetrableDefenceCD(3);\r\n    }\r\n\r\n    setImpenetrableDefenceCD(cd:number){\r\n        console.log(\"setImpenetrableDefenceCD==>\", cd);\r\n        this.impenetrableDefence.node.active = true;\r\n        this.impenetrableDefence.unblink();\r\n        let action = cc.sequence(cc.delayTime(cd-1), cc.callFunc(()=>{\r\n            this.impenetrableDefence.blink();\r\n        }), cc.delayTime(1), cc.callFunc(()=>{\r\n            this.impenetrableDefence.node.active = false;\r\n        }));\r\n        action.setTag(889);\r\n        this.role.node.stopActionByTag(889);\r\n        this.role.node.runAction(action);\r\n    }\r\n\r\n    onStartGame(){\r\n        console.log(\"onStartGame===>\", GameProxy.pauseGame);\r\n        this.node.on(cc.Node.EventType.TOUCH_START, this.onTouchStart, this);\r\n        this.node.on(cc.Node.EventType.TOUCH_MOVE, this.onTouchMove, this);\r\n        this.node.on(cc.Node.EventType.TOUCH_END, this.onTouchEnd, this);\r\n        this.node.on(cc.Node.EventType.TOUCH_CANCEL, this.onTouchEnd, this);\r\n        if (!World.My.newbies.state(\"FirstEntryGame\")){\r\n            this.guideNode.active = true;\r\n        }else {\r\n            this.getComponent(GameController).startGenerating();\r\n        }\r\n    }\r\n\r\n    onReliveGame(){\r\n        this.onInitGame();\r\n        let weaponConfig = ExcelConfig.getExcelTable(ExcelTableNames.Weapon).filter(value => value['id'] != 1).sort(((a, b) => b['unlock'] - a['unlock']));\r\n        for (let item of weaponConfig){\r\n            if (GameProxy.level >= item['unlock']){\r\n                this.bulletEmitter = item['id'];\r\n                this.bulletEmitterDelegate.payload = this.bulletEmitterDelegate.payload * 3;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    onRolePositionChanged(){\r\n        this.hpProgressBar.node.position = this.role.node.position;\r\n        this._takeProps.forEach(value => {\r\n            if (value.active){\r\n                value.position = this.role.node.position;\r\n            }\r\n        });\r\n    }\r\n\r\n    onPropTrigger(prop:PropBase) {\r\n        let takePropNode = this.getInactiveTakePropNode();\r\n        takePropNode.position = this.role.node.position;\r\n        takePropNode.active = true;\r\n        takePropNode.scale = 1;\r\n        takePropNode.opacity = 255;\r\n        takePropNode.runAction(cc.sequence(cc.scaleTo(0.3, 4), cc.fadeTo(0.3, 80), cc.callFunc(()=>{\r\n            takePropNode.active = false;\r\n        })));\r\n        let propID = prop.propID;\r\n        let propMove = (callback?:()=>void)=>{\r\n            let propBaseNode = cc.instantiate(prop.node);\r\n            propBaseNode.position = this.propStateNode.getParent().convertToNodeSpaceAR(prop.node.convertToWorldSpaceAR(cc.v2()));\r\n            this.propStateNode.getParent().addChild(propBaseNode);\r\n            /** 飞到状态栏的位置 */\r\n            let flyDuration = 0.3;\r\n            let propStateNode = cc.instantiate(this.propStatePrefab);\r\n            this.propStateNode.addChild(propStateNode);\r\n            propStateNode.scale = 0;\r\n            propStateNode.runAction(cc.scaleTo(flyDuration, 1));\r\n            propBaseNode.runAction(cc.sequence(cc.moveTo(flyDuration, this.propStateNode.position.add(cc.v2(0, -78/2))), cc.callFunc(()=>{\r\n                this.propStateNode.children.forEach(value => {\r\n                    let propStateConroller = value.getComponent(PropStateController);\r\n                    if (propStateConroller.propID == propID && value != propStateNode){\r\n                        propStateConroller.cdTimer.pause = true;\r\n                        propStateConroller.node.active = false;\r\n                    }\r\n                });\r\n                let propStateConroller = propStateNode.getComponent(PropStateController);\r\n                propStateConroller.init(propID);\r\n                propStateConroller.cdTimer.pause = false;\r\n                propBaseNode.destroy();\r\n                if (callback){\r\n                    callback();\r\n                }\r\n            })));\r\n        };\r\n        switch (propID) {\r\n            case 5:\r\n                this.setImpenetrableDefenceCD(10+0.3);\r\n                break;\r\n            case 11:\r\n                this.role.addSupply(propID);\r\n                this.huiXue(Math.floor(this.maxHp*0.3));\r\n                break;\r\n            case 9:\r\n                this.role.addSupply(propID);\r\n                propMove();\r\n                this.role.accSpeed = 1.5;\r\n                break;\r\n            case 10:\r\n                propMove();\r\n                break;\r\n            case 12:\r\n                this.role.addSupply(propID);\r\n                propMove();\r\n                GameProxy.goldMul = 2;\r\n                break;\r\n            case 13:\r\n                GameProxy.magnetic = true;\r\n                propMove();\r\n                break;\r\n            case 102:\r\n            case 103:\r\n            case 104:\r\n            case 105:\r\n            case 106:\r\n            case 107:\r\n            case 108:\r\n            case 109:\r\n            case 110:\r\n                if (this.bulletEmitter == propID - 100){\r\n                    this.bulletEmitterDelegate.bulletCount = this.bulletEmitterDelegate.payload;\r\n                }else {\r\n                    this.bulletEmitter = propID - 100;\r\n                }\r\n                break;\r\n        }\r\n    }\r\n\r\n    onPropCDZero(id:number){\r\n        switch (id){\r\n            case 5:\r\n                this.impenetrableDefence.node.active = false;\r\n                break;\r\n            case 9:\r\n                this.role.accSpeed = 1;\r\n                break;\r\n            case 10:\r\n                break;\r\n            case 12:\r\n                GameProxy.goldMul = 1;\r\n                break;\r\n            case 13:\r\n                GameProxy.magnetic = false;\r\n                break;\r\n        }\r\n    }\r\n\r\n    private _bgNode:cc.Node = null;\r\n    private _screenRect:cc.Rect = cc.rect(0, 0, cc.visibleRect.width, cc.visibleRect.height);\r\n\r\n    start(){\r\n        let bgNode = this.role.node.getParent();\r\n        this._bgNode = bgNode;\r\n        this._roleBounds.x = -bgNode.width/2 + this.role.spaceCircleCollider.radius;\r\n        this._roleBounds.y = -bgNode.height/2 + this.role.spaceCircleCollider.radius;\r\n        this._roleBounds.width = bgNode.width - this.role.spaceCircleCollider.radius*2;\r\n        this._roleBounds.height = bgNode.height - this.role.spaceCircleCollider.radius*2;\r\n\r\n        this._bgBounds.x = -this.bgLayer.width/2 + cc.view.getVisibleSize().width/2;\r\n        this._bgBounds.y = -this.bgLayer.height/2 + cc.view.getVisibleSize().height/2;\r\n        this._bgBounds.width = this.bgLayer.width - cc.view.getVisibleSize().width;\r\n        this._bgBounds.height = this.bgLayer.height - cc.view.getVisibleSize().height;\r\n\r\n\r\n        // console.log(this._roleBounds, \"this._roleBounds===>\");\r\n        // let node = new cc.Node();\r\n        // bgNode.addChild(node);\r\n        // let graphic = node.addComponent(cc.Graphics);\r\n        // graphic.strokeColor = cc.Color.RED;\r\n        // graphic.lineWidth = 5;\r\n        // graphic.rect(-bgNode.width/2, -bgNode.height/2, bgNode.width, bgNode.height);\r\n        // graphic.stroke();\r\n        //\r\n        // graphic = this.role.node.addComponent(cc.Graphics);\r\n        // graphic.strokeColor = cc.Color.RED;\r\n        // graphic.lineWidth = 3;\r\n        // graphic.circle(this.role.spaceCircleCollider.offset.x, this.role.spaceCircleCollider.offset.y, this.role.spaceCircleCollider.radius);\r\n        // graphic.stroke();\r\n        /** 移动控制 */\r\n        this.node.runAction(Actions.update(dt=>{\r\n            /**\r\n             * 角色移动\r\n             * 有控制的情况下才能移动\r\n             * 小于边界内才能移动\r\n             * */\r\n            let roleMoveLen = this.role.speed*dt;\r\n            if (this._bMove && !GameProxy.pauseGame){\r\n                let deltaPos = this._dir.mul(roleMoveLen);\r\n                let destPos = this.role.node.position.add(deltaPos);\r\n\r\n                let arr:Array<AABBRegion> = [];\r\n                window['GameCollisionController'].looseQuadTree.retrieve(this.role.roleAABB.aabb(),arr);\r\n                let flag = false;\r\n\r\n                for (let aabbRegion of arr){\r\n                    let enemy = (<EnemyAABB>aabbRegion).enemy;\r\n                    if (enemy.node.position.sub(destPos).mag() < enemy.spaceCircleCollider.radius + this.role.spaceCircleCollider.radius){\r\n                        flag = true;\r\n                        break;\r\n                    }\r\n                }\r\n                if (!flag){\r\n                    if (destPos.x > this._roleBounds.xMax || destPos.x < this._roleBounds.xMin || destPos.y > this._roleBounds.yMax || destPos.y < this._roleBounds.yMin){\r\n                        flag = true;\r\n                    }\r\n                }\r\n\r\n                if (!flag){\r\n                    this.role.node.position = destPos;\r\n                }\r\n                /*if (deltaPos.x > 0){\r\n                    if (destPos.x > this._roleBounds.xMax){\r\n                        destPos.x = this._roleBounds.xMax;\r\n                    }\r\n                }else if (deltaPos.x < 0){\r\n                    if (destPos.x < this._roleBounds.xMin){\r\n                        destPos.x = this._roleBounds.xMin;\r\n                    }\r\n                }\r\n\r\n                if (deltaPos.y > 0){\r\n                    if (destPos.y > this._roleBounds.yMax){\r\n                        destPos.y = this._roleBounds.yMax;\r\n                    }\r\n                }else if (deltaPos.y < 0){\r\n                    if (destPos.y < this._roleBounds.yMin){\r\n                        destPos.y = this._roleBounds.yMin;\r\n                    }\r\n                }*/\r\n\r\n\r\n                // let intersections = [];\r\n                // /** 求线段与边线的交点 */\r\n                // if (deltaPos.x > 0 && destPos.x > this._roleBounds.xMax){\r\n                //     //与右边界的交点\r\n                //     let point = cc.v2();\r\n                //     if(cc.Intersection.pLineIntersect(this.role.node.position, destPos, cc.v2(this._roleBounds.xMax, this._roleBounds.yMin), cc.v2(this._roleBounds.xMax, this._roleBounds.yMax), point)){\r\n                //         intersections.push(point);\r\n                //     }\r\n                // }\r\n                // if (deltaPos.x < 0 && destPos.x < this._roleBounds.xMin){\r\n                //     //与左边界的交点\r\n                //     let point = cc.v2();\r\n                //     if(cc.Intersection.pLineIntersect(this.role.node.position, destPos, cc.v2(this._roleBounds.xMin, this._roleBounds.yMin), cc.v2(this._roleBounds.xMin, this._roleBounds.yMax), point)){\r\n                //         intersections.push(point);\r\n                //     }\r\n                // }\r\n                // if (deltaPos.y > 0 && destPos.y > this._roleBounds.yMax){\r\n                //     //与上边界的交点\r\n                //     let point = cc.v2();\r\n                //     if(cc.Intersection.pLineIntersect(this.role.node.position, destPos, cc.v2(this._roleBounds.xMin, this._roleBounds.yMax), cc.v2(this._roleBounds.xMax, this._roleBounds.yMax), point)){\r\n                //         intersections.push(point);\r\n                //     }\r\n                // }\r\n                // if (deltaPos.y < 0 && destPos.y < this._roleBounds.yMin){\r\n                //     //与下边界的交点\r\n                //     let point = cc.v2();\r\n                //     if(cc.Intersection.pLineIntersect(this.role.node.position, destPos, cc.v2(this._roleBounds.xMin, this._roleBounds.yMin), cc.v2(this._roleBounds.xMax, this._roleBounds.yMin), point)){\r\n                //         intersections.push(point);\r\n                //     }\r\n                // }\r\n\r\n                /** 求线段与圆的交点 */\r\n\r\n                // arr.forEach(value => {\r\n                //     let enemy = value.getComponent(Enemy);\r\n                //     // cc.Intersection.pLineCircle(this.role.node.position, destPos, {position:enemy.node.position, radius:enemy.spaceCircleCollider.radius}, intersections);\r\n                //     let doubleRadius = enemy.spaceCircleCollider.radius + this.role.spaceCircleCollider.radius;\r\n                //     if (cc.Intersection.pointLineDistance(enemy.node.position, this.role.node.position, destPos, true) < doubleRadius){\r\n                //         console.log(\"与怪物相交，求最小移动距离\");\r\n                //         /** 距离 */\r\n                //         let centerSub = enemy.node.position.sub(this.role.node.position);\r\n                //         let centerLen = centerSub.mag();\r\n                //         if (centerLen > doubleRadius){\r\n                //             /** 求夹角 */\r\n                //             let radians = destPos.angle(centerSub);\r\n                //             if (radians > 0){\r\n                //                 /** 求垂线 */\r\n                //                 let vLen = centerLen * Math.sin(radians);\r\n                //                 if (vLen < doubleRadius){\r\n                //                     let sideLen = Math.sqrt(doubleRadius*doubleRadius - vLen*vLen);\r\n                //                     let hLen = centerLen * Math.cos(radians);\r\n                //                     intersections.push(this.node.position.add(this._dir.mul(hLen - sideLen)));\r\n                //                 }\r\n                //             } else {\r\n                //                 intersections.push(this.node.position.add(this._dir.mul(centerLen - doubleRadius)));\r\n                //             }\r\n                //         }\r\n                //     }\r\n                // });\r\n\r\n                // if (intersections.length > 0){\r\n                //     console.log(intersections, \"intersections..\");\r\n                //     if (intersections.length == 1){\r\n                //         let t = cc.v2();\r\n                //         this.role.node.position = intersections[0].addSelf(this._dir.neg(t));\r\n                //     }else {\r\n                //         /** 求距离role最近的那个 */\r\n                //         let p = intersections[0];\r\n                //         let minDistance = p.sub(this.role.node.position).mag();\r\n                //         for (let i=1; i<intersections.length; i++){\r\n                //             let mag = intersections[i].sub(this.role.node.position).mag();\r\n                //             if (mag < minDistance){\r\n                //                 p = intersections[i];\r\n                //                 minDistance = mag;\r\n                //             }\r\n                //         }\r\n                //         let t = cc.v2();\r\n                //         this.role.node.position = p.addSelf(this._dir.neg(t));\r\n                //     }\r\n                // } else {\r\n                //     this.role.node.position = destPos;\r\n                // }\r\n            }\r\n\r\n            /**\r\n             * 地图的移动\r\n             * --它的移动速度比角色要慢一点\r\n             * --要保证角色的点在屏幕中心\r\n             * */\r\n            let sub = cc.v2(-this.role.node.x, -this.role.node.y).sub(bgNode.position);\r\n            let mag = sub.mag();\r\n            let normalize = sub.normalize();\r\n            if (mag > 0){\r\n                let speed = roleMoveLen*(mag>50?1:5/6);\r\n                let x = speed*normalize.x;\r\n                let y = speed*normalize.y;\r\n                if (Math.abs(x) > Math.abs(sub.x)){\r\n                    x = sub.x;\r\n                }\r\n                if (Math.abs(y) > Math.abs(sub.y)){\r\n                    y = sub.y;\r\n                }\r\n                let destX = bgNode.x + x;\r\n                let destY = bgNode.y + y;\r\n                if (destX < this._bgBounds.xMin){\r\n                    destX = this._bgBounds.xMin;\r\n                } else if (destX > this._bgBounds.xMax){\r\n                    destX = this._bgBounds.xMax;\r\n                }\r\n                if (destY < this._bgBounds.yMin){\r\n                    destY = this._bgBounds.yMin;\r\n                } else if (destY > this._bgBounds.yMax){\r\n                    destY = this._bgBounds.yMax;\r\n                }\r\n                bgNode.x = destX;\r\n                bgNode.y = destY;\r\n            }\r\n        }));\r\n        let gameEnemysController = window['GameEnemysController'];\r\n        if (GameProxy.prepareGun > 0){\r\n            this.bulletEmitter = GameProxy.prepareGun;\r\n            this.bulletEmitterDelegate.payload = this.bulletEmitterDelegate.payload * 3;\r\n            GameProxy.prepareGun = 0;\r\n        } else {\r\n            this.bulletEmitter = BulletEmitter.TYPES.ShouQiang;\r\n        }\r\n        /** 发射控制 */\r\n        this.node.runAction(Actions.update(dt => {\r\n            if (GameProxy.pauseGame || GameProxy.slowGame)return;\r\n            if (this._fireCD > 0){\r\n                this._fireCD -= dt;\r\n            }\r\n            /** 找到离角度最近的敌人 */\r\n            let enemyNode:cc.Node = null;\r\n            let minSub = null;\r\n            let minDistance = this.bulletEmitterDelegate.firingRange;\r\n            // console.log(minDistance, \"minDistance\");\r\n            this._screenRect.x = -this._bgNode.x - cc.visibleRect.center.x;\r\n            this._screenRect.y = -this._bgNode.y - cc.visibleRect.center.y;\r\n            let rolePos = this.role.node.position;\r\n            gameEnemysController.enemyLayer.children.forEach(value => {\r\n                if (value.active && value.getComponent(Enemy).hp > 0 && this._screenRect.contains(value.position)){\r\n                    let sub = value.position.sub(rolePos);\r\n                    let mag = sub.mag();\r\n                    if (mag < minDistance){\r\n                        minSub = sub;\r\n                        minDistance = mag;\r\n                        enemyNode = value;\r\n                    }\r\n                }\r\n            });\r\n            if (enemyNode){\r\n                /** 转向敌人 */\r\n                this.turnTo(minSub);\r\n                if (this._fireCD <= 0){\r\n                    /** 根据攻击距离计算攻击夹角 */\r\n                    let attackRadian = Math.atan(enemyNode.getComponent(Enemy).spaceCircleCollider.radius/minDistance);\r\n                    if (minSub.angle(cc.v2(0, 1).rotate(cc.misc.degreesToRadians(-this.role.node.rotation))) < attackRadian){\r\n                        /** fire */\r\n                        this._fireCD = this.bulletEmitterDelegate.interval;\r\n                        let dir = enemyNode.position.sub(rolePos).normalize();\r\n                        if (dir.x == 0 && dir.y == 0){\r\n                            dir = cc.v2(0, 1).normalize().rotate(cc.misc.degreesToRadians(-this.role.node.rotation));\r\n                        }\r\n                        if (this._bulletEmitter == BulletEmitter.TYPES.JuJiQiang){\r\n                            let bulletStrikePrefab = cc.loader.getRes(\"prefab/entities/bullet/fire7\");\r\n                            let bulletStrikeNode = cc.instantiate(bulletStrikePrefab);\r\n                            this.bulletStrikeLayer.addChild(bulletStrikeNode);\r\n                            bulletStrikeNode.position = this.role.node.position.add(dir.mul(this.role.gunTopNode.y));\r\n                            bulletStrikeNode.rotation = 90 - cc.misc.radiansToDegrees(Math.atan2(dir.y, dir.x));\r\n                            bulletStrikeNode.getComponent(sp.Skeleton).setCompleteListener(()=>{\r\n                                bulletStrikeNode.destroy();\r\n                            });\r\n                        } else if (this._bulletEmitter !== BulletEmitter.TYPES.JiGuang && this._bulletEmitter !== BulletEmitter.TYPES.PenZi){\r\n                            this.role.fireSprite.node.scale = 1;\r\n                            this.role.fireSprite.node.active = true;\r\n                            this.role.fireSprite.node.runAction(cc.sequence(cc.scaleTo(0.05, 0.5), cc.callFunc(()=>{\r\n                                this.role.fireSprite.node.active = false;\r\n                            })));\r\n                        }\r\n                        this._bulletEmitterDelegate.fire(this.role.node.position.add(dir.mul(this.role.gunTopNode.y)), dir);\r\n                        let str = 'sound/msc_g'+( \"0000000000000000\" + this._bulletEmitter ).substr( -3 );\r\n                        Music.playSFX(str, EmitterSfxVolumes[this._bulletEmitter-1]);\r\n                        if (this._bulletEmitterDelegate.isUseUp()){\r\n                            this.bulletEmitter = BulletEmitter.TYPES.ShouQiang;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n        }))\r\n    }\r\n\r\n    turnTo(dir:cc.Vec2){\r\n        let degree = (90 - cc.misc.radiansToDegrees(Math.atan2(dir.y, dir.x)))%360;\r\n        // console.log(\"de===>\", degree);\r\n        // console.log(\"dir===>x=\"+dir.x+\" y=\"+dir.y);\r\n        if (degree < 0){\r\n            degree += 360;\r\n        }\r\n        let enemyRotation = this.role.node.rotation%360;\r\n        if (enemyRotation < 0){\r\n            enemyRotation += 360;\r\n        }\r\n        let subDegree = Math.abs(degree - enemyRotation);\r\n        // console.log(\"degree=\"+degree);\r\n        // console.log(\"enemyRotation====>\"+enemyRotation);\r\n        if (subDegree > 0){\r\n            let rotation = 0;\r\n            if (subDegree > 180){\r\n                rotation = Math.sign(enemyRotation - degree) * 10;\r\n                if (Math.abs(rotation) > 360 - subDegree){\r\n                    rotation = Math.sign(rotation)*(360-subDegree);\r\n                }\r\n            }else {\r\n                rotation = Math.sign(degree - enemyRotation) * 10;\r\n                if (Math.abs(rotation) > subDegree){\r\n                    rotation = Math.sign(rotation) * subDegree;\r\n                }\r\n            }\r\n            enemyRotation += rotation;\r\n        }\r\n        this.role.node.rotation = enemyRotation;\r\n    }\r\n\r\n    onDestroy(){\r\n        this.node.off(cc.Node.EventType.TOUCH_START, this.onTouchStart, this);\r\n        this.node.off(cc.Node.EventType.TOUCH_MOVE, this.onTouchMove, this);\r\n        this.node.off(cc.Node.EventType.TOUCH_END, this.onTouchEnd, this);\r\n        this.node.off(cc.Node.EventType.TOUCH_CANCEL, this.onTouchEnd, this);\r\n    }\r\n\r\n    onTouchStart(event:cc.Event.EventTouch){\r\n        // console.log(\"onTouchStart===>\", this._touchId, GameProxy.pauseGame);\r\n        if (this._touchId == null){\r\n            this.touchId = event.getID();\r\n            this._bMove = false;\r\n            this.ring.opacity = RING_OPACITY;\r\n            this.dot.opacity = RING_OPACITY;\r\n            // 更改摇杆的位置\r\n            this.ring.setPosition(event.getLocation().sub(cc.visibleRect.center));\r\n            this.dot.setPosition(cc.v2(0, 0));\r\n        }\r\n    }\r\n\r\n    onTouchMove(event:cc.Event.EventTouch){\r\n        // console.log(\"onTouchMove===>\", this._touchId, GameProxy.pauseGame);\r\n        if (!GameProxy.pauseGame && event.getID() == this._touchId){\r\n            this._bMove = true;\r\n            if (this.guideNode.active && this.dot.position.mag() > 30){\r\n                this.guideNode.active = false;\r\n                World.My.newbies.finish(\"FirstEntryGame\");\r\n                this.getComponent(GameController).startGenerating();\r\n            }\r\n\r\n            let pos = this.dot.position.add(event.getDelta());\r\n            this._dir = pos.normalize();\r\n            if (pos.mag() >= this._radius){\r\n                this.dot.position = this._dir.mul(this._radius);\r\n                this.role.speedType = SpeedType.FAST;\r\n                this.ring.position = event.getLocation().sub(cc.visibleRect.center).sub(this.dot.position);\r\n            }else {\r\n                this.dot.position = pos;\r\n                this.role.speedType = SpeedType.NORMAL;\r\n            }\r\n        }\r\n    }\r\n\r\n    onTouchEnd(event:cc.Event.EventTouch){\r\n        // console.log(\"onTouchEnd===>\", this._touchId, GameProxy.pauseGame);\r\n        if (!GameProxy.pauseGame && event.getID() == this._touchId){\r\n            this.touchId = null;\r\n            this._bMove = false;\r\n            this.dot.setPosition(this.ring.getPosition());\r\n            if (this.joystickType == JoystickType.FOLLOW) {\r\n                this.ring.opacity = 0;\r\n                this.dot.opacity = 0;\r\n            }\r\n            // this.role.speedType = SpeedType.STOP;\r\n        }\r\n    }\r\n\r\n}\r\n"]}