{"version":3,"sources":["assets/script/app/home/RecommendController.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\nimport BulletEmitterShouQiang from \"../entities/bulletEmitter/BulletEmitterShouQiang\";\r\nimport BulletEmitterJuJiQiang from \"../entities/bulletEmitter/BulletEmitterJuJiQiang\";\r\nimport BulletEmitterJiaTeLin from \"../entities/bulletEmitter/BulletEmitterJiaTeLin\";\r\nimport BulletEmitterJiGuang from \"../entities/bulletEmitter/BulletEmitterJiGuang\";\r\nimport BulletEmitterHuoYan from \"../entities/bulletEmitter/BulletEmitterHuoYan\";\r\nimport BulletEmitterHuoJianTong from \"../entities/bulletEmitter/BulletEmitterHuoJianTong\";\r\nimport BulletEmitterLiZiPao from \"../entities/bulletEmitter/BulletEmitterLiZiPao\";\r\nimport BulletEmitterPenZi from \"../entities/bulletEmitter/BulletEmitterPenZi\";\r\nimport BulletEmitterSanDanQiang from \"../entities/bulletEmitter/BulletEmitterSanDanQiang\";\r\nimport BulletEmitterShanDianQiu from \"../entities/bulletEmitter/BulletEmitterShanDianQiu\";\r\nimport BulletEmitter from \"../entities/bulletEmitter/BulletEmitter\";\r\nimport Role from \"../entities/role/Role\";\r\nimport Actions from \"../../../framework/actions/Actions\";\r\nimport {ExcelConfig} from \"../../../framework/config/ExcelConfig\";\r\nimport {ExcelTableNames} from \"../config/ExcelTableNames\";\r\nimport {World} from \"../info/World\";\r\nimport Facade from \"../../../framework/facade/Facade\";\r\nimport HomeController from \"./HomeController\";\r\nimport {GameProxy} from \"../game/GameProxy\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class RecommendController extends cc.Component {\r\n\r\n    @property(Role)\r\n    role:Role = null;\r\n\r\n    @property(cc.Node)\r\n    useNode:cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    noUseNode:cc.Node = null;\r\n\r\n    private _fireCD = 0;\r\n\r\n    private _gunId = 1;\r\n\r\n    onLoad() {\r\n        cc.game.on(\"video_3\",()=>{\r\n            this.onClickUseDo()\r\n        },this);\r\n    }\r\n\r\n    start () {\r\n        this.noUseNode.on(cc.Node.EventType.POSITION_CHANGED, ()=>{\r\n            this.useNode.position = this.noUseNode.position.add(cc.v2(0, 87));\r\n        });\r\n        let gameBulletsController = window['GameBulletsController'];\r\n        gameBulletsController.bulletLayer.on(cc.Node.EventType.CHILD_ADDED, (bulletNode:cc.Node)=>{\r\n            bulletNode.group = \"ui\";\r\n        });\r\n        let bulletEmitter:BulletEmitter = null;\r\n        let bulletEmitterType = 2;\r\n        let weaponConfig = ExcelConfig.getExcelTable(ExcelTableNames.Weapon).filter(value => value['id'] != 1).sort(((a, b) => b['unlock'] - a['unlock']));\r\n        for (let item of weaponConfig){\r\n            if (World.Storage.gameLevel >= item['unlock']){\r\n                bulletEmitterType = item['id'];\r\n                break;\r\n            }\r\n        }\r\n        if (bulletEmitterType > 7){\r\n            bulletEmitterType = 7;\r\n        }\r\n        this._gunId = bulletEmitterType;\r\n        let promises = [];\r\n        promises.push(cc.loader.loadResAwait('prefab/entities/bullet/bullet'+bulletEmitterType));\r\n        if (bulletEmitterType == BulletEmitter.TYPES.LiZiPao){\r\n            promises.push(cc.loader.loadResAwait('prefab/entities/bullet/bullet108'));\r\n        }else if (bulletEmitterType == BulletEmitter.TYPES.HuoJianTong){\r\n            promises.push(cc.loader.loadResAwait('prefab/entities/explosive/explosive9'));\r\n        }else if (bulletEmitterType == BulletEmitter.TYPES.JuJiQiang){\r\n            promises.push(cc.loader.loadResAwait('prefab/entities/bullet/fire7'));\r\n        }\r\n        Promise.all(promises).then(()=>{\r\n            switch (bulletEmitterType){\r\n                case BulletEmitter.TYPES.ShouQiang:\r\n                    bulletEmitter = new BulletEmitterShouQiang(gameBulletsController);\r\n                    break;\r\n                case BulletEmitter.TYPES.PenZi:\r\n                    bulletEmitter = new BulletEmitterPenZi(gameBulletsController);\r\n                    break;\r\n                case BulletEmitter.TYPES.JiaTeLin:\r\n                    bulletEmitter = new BulletEmitterJiaTeLin(gameBulletsController);\r\n                    break;\r\n                case BulletEmitter.TYPES.SanDanQiang:\r\n                    bulletEmitter = new BulletEmitterSanDanQiang(gameBulletsController);\r\n                    break;\r\n                case BulletEmitter.TYPES.JuJiQiang:\r\n                    bulletEmitter = new BulletEmitterJuJiQiang(gameBulletsController);\r\n                    break;\r\n                case BulletEmitter.TYPES.LiZiPao:\r\n                    bulletEmitter = new BulletEmitterLiZiPao(gameBulletsController);\r\n                    break;\r\n                case BulletEmitter.TYPES.HuoJianTong:\r\n                    bulletEmitter = new BulletEmitterHuoJianTong(gameBulletsController);\r\n                    break;\r\n                case BulletEmitter.TYPES.ShanDianQiu:\r\n                    bulletEmitter = new BulletEmitterShanDianQiu(gameBulletsController);\r\n                    break;\r\n                case BulletEmitter.TYPES.JiGuang:\r\n                    bulletEmitter = new BulletEmitterJiGuang(gameBulletsController);\r\n                    break;\r\n                case BulletEmitter.TYPES.HuoYan:\r\n                    bulletEmitter = new BulletEmitterHuoYan(gameBulletsController);\r\n                    break;\r\n            }\r\n            bulletEmitter.init(bulletEmitterType);\r\n            if (bulletEmitterType == BulletEmitter.TYPES.JiGuang){\r\n                let bullet = bulletEmitter.gameBulletsController.getInactiveBullet(BulletEmitter.TYPES.JiGuang);\r\n                bullet.collider.enabled = false;\r\n                let ske = bullet.getComponent(sp.Skeleton);\r\n                ske.setStartListener((trackEntry, loopCount)=>{\r\n                    let name = trackEntry.animation ? trackEntry.animation.name : '';\r\n                    if(name === \"jiguang\"){\r\n                        bullet.collider.enabled = true;\r\n                    }\r\n                });\r\n                ske.setCompleteListener((trackEntry, loopCount) => {\r\n                    let name = trackEntry.animation ? trackEntry.animation.name : '';\r\n                    if (name === \"xuneng\") {\r\n                        ske.setAnimation(0, \"jiguang\", false);\r\n                    }else if(name === \"jiguang\"){\r\n                        bulletEmitter.bulletCount--;\r\n                        bullet.collider.enabled = false;\r\n                        bullet.node.runAction(cc.sequence(cc.delayTime(0), cc.callFunc(()=>{\r\n                            if (!bullet.collider.enabled){\r\n                                bullet.node.active = false;\r\n                            }\r\n                        })));\r\n                    }\r\n                });\r\n                bulletEmitter._bulletJiGuangSke = ske;\r\n                bulletEmitter._bulletJiGuang = bullet;\r\n                bulletEmitter._bulletJiGuang.node.rotation = this.role.node.rotation;\r\n                bulletEmitter._bulletJiGuang.node.position = this.role.node.position.add(cc.v2(0, 1).rotate(cc.misc.degreesToRadians(-this.role.node.rotation)).normalize().mul(this.role.gunTopNode.y + 20));\r\n            }\r\n\r\n            let dir = cc.v2(0, 1000).sub(this.role.node.position).normalize();\r\n\r\n            this.node.runAction(Actions.update(dt => {\r\n                if (this._fireCD > 0) {\r\n                    this._fireCD -= dt;\r\n                }else {\r\n                    this._fireCD = bulletEmitter.interval;\r\n                    if (bulletEmitterType == BulletEmitter.TYPES.JuJiQiang){\r\n                        let bulletStrikePrefab = cc.loader.getRes(\"prefab/entities/bullet/fire7\");\r\n                        let bulletStrikeNode = cc.instantiate(bulletStrikePrefab);\r\n                        gameBulletsController.bulletLayer.addChild(bulletStrikeNode, 0);\r\n                        bulletStrikeNode.position = this.role.node.position.add(dir.mul(this.role.gunTopNode.y));\r\n                        bulletStrikeNode.rotation = 90 - cc.misc.radiansToDegrees(Math.atan2(dir.y, dir.x));\r\n                        bulletStrikeNode.getComponent(sp.Skeleton).setCompleteListener(()=>{\r\n                            bulletStrikeNode.destroy();\r\n                        });\r\n                    } else if (bulletEmitterType !== BulletEmitter.TYPES.JiGuang && bulletEmitterType !== BulletEmitter.TYPES.PenZi){\r\n                        this.role.fireSprite.node.scale = 1;\r\n                        this.role.fireSprite.node.active = true;\r\n                        this.role.fireSprite.node.runAction(cc.sequence(cc.scaleTo(0.05, 0.5), cc.callFunc(()=>{\r\n                            this.role.fireSprite.node.active = false;\r\n                        })));\r\n                    }\r\n                    bulletEmitter.fire(this.role.node.position.add(dir.mul(this.role.gunTopNode.y)), dir);\r\n                }\r\n            }));\r\n        });\r\n    }\r\n\r\n    onClickUse(event, data){\r\n        console.log(\"【video】3 装备推荐【click】RecommendController Use\")\r\n\r\n        World.Storage._videoSign=3\r\n        World.Storage.videoAd_show()    \r\n    }\r\n\r\n    onClickUseDo(){\r\n        GameProxy.prepareGun = this._gunId;\r\n        Facade.findComponent(\"HomeScene\", HomeController).playExit();\r\n        this.node.destroy();\r\n    }\r\n\r\n    onClickNoUse(event, data){\r\n        console.log(\"【click】RecommendController NoUse\")\r\n\r\n        Facade.findComponent(\"HomeScene\", HomeController).playExit();\r\n        this.node.destroy();\r\n    }\r\n}\r\n"]}