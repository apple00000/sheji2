{"version":3,"sources":["assets/script/app/home/WeaponLayerController.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\nimport {World} from \"../info/World\";\r\nimport Network from \"../network/Network\";\r\nimport {NetworkConfig} from \"../config/NetworkConfig\";\r\nimport {ext} from \"../../../framework/extend/Extend\";\r\nimport Toast from \"../../../framework/extend/Toast\";\r\nimport {ExcelConfig} from \"../../../framework/config/ExcelConfig\";\r\nimport {ExcelTableNames} from \"../config/ExcelTableNames\";\r\nimport Facade from \"../../../framework/facade/Facade\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class WeaponLayerController extends cc.Component {\r\n\r\n    @property(cc.RichText)\r\n    firePowerLvLabel: cc.RichText = null;\r\n\r\n    @property(cc.RichText)\r\n    powerLvLabel: cc.RichText = null;\r\n\r\n    @property(cc.RichText)\r\n    firePowerCostLabel: cc.RichText = null;\r\n\r\n    @property(cc.RichText)\r\n    powerCostLabel: cc.RichText = null;\r\n\r\n    @property(cc.RichText)\r\n    firePowerWorthLabel: cc.RichText = null;\r\n\r\n    @property(cc.RichText)\r\n    powerWorthLabel: cc.RichText = null;\r\n\r\n    @property(cc.Button)\r\n    firePowerButton:cc.Button = null;\r\n\r\n    @property(cc.Button)\r\n    powerButton:cc.Button = null;\r\n\r\n    @property(cc.ScrollView)\r\n    scrollView:cc.ScrollView = null;\r\n\r\n    @property(cc.Node)\r\n    upEffectNode:cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    trialNode:cc.Node = null;\r\n\r\n    weaponButtons:[cc.Button] = [];\r\n\r\n    private _weaponFocus = -1;\r\n\r\n    focusGunID(){\r\n        return this._orders[this._weaponFocus]['id'];\r\n    }\r\n\r\n\r\n    set weaponFocus(value: number) {\r\n        if (this._weaponFocus != value){\r\n            this.upEffectNode.removeFromParent(false);\r\n            this.weaponButtons[value].node.addChild(this.upEffectNode);\r\n            this._weaponFocus = value;\r\n            this.weaponButtons.forEach((value, index) => value.target.getComponent(cc.Sprite).enabled = index == this._weaponFocus);\r\n            this.updateWeaponAttr();\r\n        }\r\n    }\r\n\r\n    updateWeaponAttr(){\r\n        this.updateFirePower();\r\n        this.updatePower();\r\n    }\r\n\r\n    private _orders = [];\r\n\r\n    onLoad () {\r\n        this.trialNode.active = false;\r\n        this.weaponButtons = this.scrollView.content.children.map(value => value.getComponent(cc.Button));\r\n        let config = ExcelConfig.getExcelTable(ExcelTableNames.Weapon);\r\n        this._orders = config.filter(value => value['id'] != 1).sort(((a, b) => {\r\n            return a['order'] - b['order'];\r\n        }));\r\n        this.weaponButtons.forEach(value => {\r\n            let id = parseInt(value.node.name);\r\n            let cfg = this._orders[id-2];\r\n            value.node.getChildByName(\"Background\").getChildByName(\"Label\").getComponent(cc.Label).string = cfg['gun_name'];\r\n            // let weaponSke = value.node.getChildByName(\"Background\").getChildByName(\"weapon\").getComponent(sp.Skeleton);\r\n            // weaponSke.setSkin((\"000\"+cfg['id']).substr(-3));\r\n            // weaponSke.setAnimation(0, \"gun\", false);\r\n            value.node.getChildByName(\"Background\").getChildByName(\"weapon\").active = false;\r\n            let sprite = value.node.getChildByName(\"Background\").getChildByName(\"weaponSprite\").getComponent(cc.Sprite);\r\n            let bLock = World.Storage.gameLevel < cfg['unlock'];\r\n            sprite.setMaterial(0, cc.Material.getBuiltinMaterial(bLock?\"2d-gray-sprite\":\"2d-sprite\"));\r\n            sprite.node.opacity = bLock?128:255;\r\n        });\r\n        cc.find('Canvas').on(\"UpdateStorage\", this.onUpdateStorageEvent, this);\r\n    }\r\n\r\n    start(){\r\n        /** 选中最新解锁的武器 */\r\n        let num = 0;\r\n        for (let item of this._orders){\r\n            if (World.Storage.gameLevel >= item['unlock']){\r\n                num++;\r\n            }else {\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (num <= 3){\r\n            this.scrollView.scrollToLeft();\r\n        }else if (num >= this._orders.length - 1){\r\n            this.scrollView.scrollToRight();\r\n        } else {\r\n            let x = (num-3) * this.weaponButtons[0].node.width;\r\n            this.scrollView.scrollToOffset(cc.v2(x, this.scrollView.content.y));\r\n        }\r\n        this.weaponFocus = num-1;\r\n        if (World.Storage.unlockGun > 0){\r\n            let index = this._orders.findIndex(value => value['id'] == World.Storage.unlockGun);\r\n            if (typeof index == \"undefined\"){\r\n                console.error(\"not found gun for id===>\", World.Storage.unlockGun);\r\n            }else {\r\n                this.trialNode.removeFromParent(false);\r\n                this.trialNode.active = true;\r\n                this.weaponButtons[index].node.addChild(this.trialNode);\r\n            }\r\n        }\r\n    }\r\n\r\n    onDestroy(){\r\n        cc.find('Canvas').off(\"UpdateStorage\", this.onUpdateStorageEvent, this);\r\n    }\r\n\r\n    onUpdateStorageEvent(key:string){\r\n        if (key == \"goldCount\"){\r\n            let cfg = this._orders[this._weaponFocus];\r\n            let id = cfg['id'];\r\n            let firePowerLv = World.My.armory.levelOfEmitterFirePower(id);\r\n            if (firePowerLv < cfg['lv_limit']){\r\n                let needCost = ExcelConfig.getExcelTable(ExcelTableNames.WeaponUp)[firePowerLv-1]['fire_expend'];\r\n                this.firePowerButton.interactable = World.Storage.goldCount >= needCost;\r\n                this.firePowerCostLabel.node.color = this.firePowerButton.interactable?cc.Color.WHITE:cc.Color.RED.fromHEX(\"#924338\");\r\n            }\r\n            let powerLv = World.My.armory.levelOfEmitterPower(id);\r\n            if (powerLv < cfg['lv_limit']){\r\n                let needCost = ExcelConfig.getExcelTable(ExcelTableNames.WeaponUp)[powerLv-1]['power_expend'];\r\n                this.powerButton.interactable = World.Storage.goldCount >= needCost;\r\n                this.powerCostLabel.node.color = this.powerButton.interactable?cc.Color.WHITE:cc.Color.RED.fromHEX(\"#924338\");\r\n            }\r\n        }\r\n    }\r\n\r\n    updateFirePower(){\r\n        let cfg = this._orders[this._weaponFocus];\r\n        let id = cfg['id'];\r\n        let firePowerLv = World.My.armory.levelOfEmitterFirePower(id);\r\n        this.firePowerLvLabel.string = `<b><outline color=#1e1e1e width=4>弹量 [Lv.${firePowerLv}]</outline></b>`;\r\n        if (firePowerLv >= cfg['lv_limit']){\r\n            this.firePowerCostLabel.string = `<b><outline color=#1e1e1e width=3>满级</outline></b>`;\r\n            this.firePowerButton.interactable = false;\r\n        } else {\r\n            let needCost = ExcelConfig.getExcelTable(ExcelTableNames.WeaponUp)[firePowerLv-1]['fire_expend'];\r\n            this.firePowerCostLabel.string = `<b><outline color=#1e1e1e width=3>${ext.shortFormat(needCost)}</outline></b>`;\r\n            this.firePowerButton.interactable = World.Storage.goldCount >= needCost;\r\n        }\r\n        this.firePowerCostLabel.node.color = this.firePowerButton.interactable?cc.Color.WHITE:cc.Color.RED.fromHEX(\"#924338\");\r\n        this.firePowerWorthLabel.string = `<b><outline color=#1e1e1e width=3>${ext.shortFormat(World.My.armory.payloadAddOf(id))}</outline></b>`;\r\n    }\r\n\r\n    updatePower(){\r\n        let cfg = this._orders[this._weaponFocus];\r\n        let id = cfg['id'];\r\n        let powerLv = World.My.armory.levelOfEmitterPower(id);\r\n        this.powerLvLabel.string = `<b><outline color=#1e1e1e width=4>火力 [Lv.${powerLv}]</outline></b>`;\r\n        if (powerLv >= cfg['lv_limit']){\r\n            this.powerCostLabel.string = `<b><outline color=#1e1e1e width=3>满级</outline></b>`;\r\n            this.powerButton.interactable = false;\r\n        }else {\r\n            let needCost = ExcelConfig.getExcelTable(ExcelTableNames.WeaponUp)[powerLv-1]['power_expend'];\r\n            this.powerCostLabel.string = `<b><outline color=#1e1e1e width=3>${ext.shortFormat(needCost)}</outline></b>`;\r\n            this.powerButton.interactable = World.Storage.goldCount >= needCost;\r\n        }\r\n        this.powerCostLabel.node.color = this.powerButton.interactable?cc.Color.WHITE:cc.Color.RED.fromHEX(\"#924338\");\r\n        let hurt_add = ExcelConfig.getExcelTable(ExcelTableNames.WeaponUp)[powerLv-1]['hurt_add'];\r\n        this.powerWorthLabel.string = `<b><outline color=#1e1e1e width=3>${Math.floor(hurt_add*100)}%</outline></b>`;\r\n    }\r\n\r\n    onClickWeapon(event, data){\r\n        console.log(\"【click】WeaponLayerController Weapon\")\r\n\r\n        data = parseInt(data);\r\n        let cfg = this._orders[data-2];\r\n        let bLock = World.Storage.gameLevel < cfg['unlock'];\r\n        if (bLock){\r\n            Toast.flutter({string:`<color=#faffff><b><outline color=#1e1e1e width=4>第${cfg['unlock']}关解锁该武器</outline></b></color>`, fontSize:30, y:cc.visibleRect.center.y});\r\n        }else {\r\n            this.weaponButtons[this._weaponFocus].node.getChildByName(\"Background\").getChildByName(\"weaponSprite\").active = true;\r\n            this.weaponButtons[this._weaponFocus].node.getChildByName(\"Background\").getChildByName(\"weapon\").active = false;\r\n            this.weaponFocus = data - 2;\r\n        }\r\n    }\r\n\r\n    onClickUpWeaponFirePower(event, data){\r\n        console.log(\"【click】WeaponLayerController UpWeaponFirePower\")\r\n\r\n        let cfg = this._orders[this._weaponFocus];\r\n        let id = cfg['id'];\r\n        let firePowerLv = World.My.armory.levelOfEmitterFirePower(id);\r\n        if (firePowerLv >= World.Storage.ADLv){\r\n            Toast.flutter({string:\"<color=#faffff><b><outline color=#1e1e1e width=4>等级不得高于基础战斗力</outline></b></color>\", fontSize:30, y:cc.visibleRect.center.y});\r\n            return;\r\n        }\r\n        let needCost = ExcelConfig.getExcelTable(ExcelTableNames.WeaponUp)[firePowerLv-1]['fire_expend'];\r\n        World.Storage.goldCount -= needCost;\r\n        World.My.armory.addLevelOfEmitterFirePower(id, 1);\r\n        this.updateFirePower();\r\n        Facade.canvasNode.emit(\"WeaponUp\");\r\n    }\r\n\r\n    onClickUpWeaponPower(event, data){\r\n        console.log(\"【click】WeaponLayerController UpWeaponPower\")\r\n\r\n        let cfg = this._orders[this._weaponFocus];\r\n        let id = cfg['id'];\r\n        let powerLv = World.My.armory.levelOfEmitterPower(id);\r\n        if (powerLv >= World.Storage.ADLv){\r\n            Toast.flutter({string:\"<color=#faffff><b><outline color=#1e1e1e width=4>等级不得高于基础战斗力</outline></b></color>\", fontSize:30, y:cc.visibleRect.center.y});\r\n            return;\r\n        }\r\n        let needCost = ExcelConfig.getExcelTable(ExcelTableNames.WeaponUp)[powerLv-1]['power_expend'];\r\n        World.Storage.goldCount -= needCost;\r\n        World.My.armory.addLevelOfEmitterPower(id, 1);\r\n        this.updatePower();\r\n        Facade.canvasNode.emit(\"WeaponUp\");\r\n    }\r\n\r\n    onClickToggle(toggle, data){\r\n        console.log(\"【click】WeaponLayerController Toggle\")\r\n\r\n        if (toggle.isChecked){\r\n            if (World.Storage.unlockGun > 0){\r\n                /** 切换focus */\r\n                let index = this._orders.findIndex(value => value['id'] == World.Storage.unlockGun);\r\n                console.log(\"index===>\", index);\r\n                if (typeof index == \"undefined\"){\r\n                    console.error(\"not found gun for id===>\", World.Storage.unlockGun);\r\n                } else {\r\n                    this.weaponFocus = index;\r\n                    /** 播放流光动画 */\r\n                    this.weaponButtons[index].node.getChildByName(\"Background\").getChildByName(\"weaponSprite\").active = false;\r\n                    this.weaponButtons[index].node.getChildByName(\"Background\").getChildByName(\"weapon\").active = true;\r\n                    this.weaponButtons[index].node.getChildByName(\"Background\").getChildByName(\"weapon\").getComponent(sp.Skeleton).setAnimation(0, \"gun_002\", true);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n"]}