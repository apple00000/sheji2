{"version":3,"sources":["assets/script/app/home/ExchangeController.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\nimport {World} from \"../info/World\";\r\nimport {ext} from \"../../../framework/extend/Extend\";\r\nimport {ExcelConfig} from \"../../../framework/config/ExcelConfig\";\r\nimport {ExcelTableNames} from \"../config/ExcelTableNames\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class ExchangeController extends cc.Component {\r\n\r\n    @property(cc.Button)\r\n    exchangeButton:cc.Button = null;\r\n\r\n    @property(cc.Label)\r\n    diamondLabel: cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    exchangeLabel: cc.Label = null;\r\n\r\n    @property(cc.Sprite)\r\n    exchangeSprite:cc.Sprite = null;\r\n\r\n    @property(cc.SpriteFrame)\r\n    exchangeSpriteFrames:[cc.SpriteFrame] = [];\r\n\r\n    private _diamondCount = 0;\r\n\r\n\r\n    get diamondCount(): number {\r\n        return this._diamondCount;\r\n    }\r\n\r\n    set diamondCount(value: number) {\r\n        this._diamondCount = value;\r\n        if (this._type == 1){\r\n            this.exchangeLabel.string = ext.shortFormat(this.getGoldCount());\r\n        }else {\r\n            this.exchangeLabel.string = `${this.getPowerCount()}`;\r\n        }\r\n        this.updateView();\r\n    }\r\n\r\n    private _type = 1;\r\n\r\n\r\n    set type(value: number) {\r\n        this._type = value;\r\n        this.exchangeSprite.spriteFrame = this.exchangeSpriteFrames[this._type-1];\r\n        this.diamondCount = World.Storage.diamondCount;\r\n    }\r\n\r\n    getGoldCount(){\r\n        let cfg = ExcelConfig.getExcelTable(ExcelTableNames.GoldUp);\r\n        return cfg[World.Storage.goldLv-1]['diamond_ex']*this._diamondCount;\r\n    }\r\n\r\n    getPowerCount(){\r\n        return 5 * this._diamondCount;\r\n    }\r\n\r\n    updateView(){\r\n        this.exchangeButton.interactable = this._diamondCount > 0;\r\n        this.diamondLabel.string = `${this._diamondCount}`;\r\n    }\r\n\r\n    onDiamondPlus(){\r\n        if (this._diamondCount < World.Storage.diamondCount){\r\n            this.diamondCount++;\r\n        }\r\n    }\r\n\r\n    onDiamondMinus(){\r\n        if (this._diamondCount > 0){\r\n            this.diamondCount--;\r\n        }\r\n    }\r\n\r\n    onExchange(){\r\n        if (this._type == 1){\r\n            World.Storage.goldCount += this.getGoldCount();\r\n        }else {\r\n            World.Storage.power += this.getPowerCount();\r\n        }\r\n        this.node.destroy();\r\n    }\r\n}\r\n"]}