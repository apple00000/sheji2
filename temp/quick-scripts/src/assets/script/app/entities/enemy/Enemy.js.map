{"version":3,"sources":["assets/script/app/entities/enemy/Enemy.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\n\r\nimport EnemyAABB from \"./EnemyAABB\";\r\nimport {ExcelTableNames} from \"../../config/ExcelTableNames\";\r\nimport {ExcelConfig} from \"../../../../framework/config/ExcelConfig\";\r\nimport {GameProxy} from \"../../game/GameProxy\";\r\nimport {Music} from \"../../../../framework/audio/Music\";\r\nimport {ext} from \"../../../../framework/extend/Extend\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\nconst AttackDelayList = [0.4, 0.4, 0, 0.2, 0.3, 0.3, 0.3, 0.5];\r\n\r\nconst BASE_TIME_SCALE = 1.5;\r\n\r\n@ccclass\r\nexport default class Enemy extends cc.Component {\r\n\r\n    @property(sp.Skeleton)\r\n    ske:sp.Skeleton = null;\r\n\r\n    attackCD = 1;\r\n\r\n    private _gameSlow = false;\r\n\r\n\r\n    set gameSlow(value: boolean) {\r\n        this._gameSlow = value;\r\n        let timeScale = BASE_TIME_SCALE;\r\n        if (this._gameSlow){\r\n            timeScale *= 0.2;\r\n        }\r\n        this.ske.timeScale = timeScale;\r\n    }\r\n\r\n    protected _moveSpeed = 0;\r\n\r\n    /** 速度的加成 */\r\n    protected _speedAdd = 1;\r\n\r\n    get speedAdd(): number {\r\n        return this._speedAdd;\r\n    }\r\n\r\n    set speedAdd(value: number) {\r\n        this._speedAdd = value;\r\n        this.ske.timeScale = BASE_TIME_SCALE*value;\r\n    }\r\n\r\n    protected _bAcc = false;\r\n\r\n\r\n    set bAcc(value: boolean) {\r\n        this._bAcc = value;\r\n        if (this._bAcc && this.enemyID > 3){\r\n            Music.playSFX(\"sound/msc_en003\", 0.6);\r\n        }\r\n    }\r\n\r\n    accSpeed = 0;\r\n\r\n    foundRange = 0;\r\n\r\n    attackDistance = 100;\r\n\r\n    bulletSpeed = 0;\r\n\r\n    unrepel = 0;\r\n\r\n    maxHp = 0;\r\n\r\n    /** 死后爆汁缩放 */\r\n    humorScale = 1;\r\n\r\n    /** 金币数 */\r\n    gold = 0;\r\n\r\n    /** 金币图标掉落 */\r\n    goldIconFell = 1;\r\n\r\n    speedcut = 0;\r\n\r\n    /** 移动标志 */\r\n    moveFlag = false;\r\n\r\n    /** 转向角色标志 */\r\n    lookAtRoleFlag = false;\r\n\r\n    /** 攻击冷却中 */\r\n    attackCoolingFlag = false;\r\n\r\n    /** 逻辑处理标志 */\r\n    logicFlag = false;\r\n\r\n    /** 移动方向 */\r\n    moveDir = cc.v2();\r\n\r\n\r\n    get moveSpeed(): number {\r\n        return this._moveSpeed*(this._bAcc?this.accSpeed:1) * this._speedAdd * (this._gameSlow?0.2:1);\r\n    }\r\n\r\n    /** 僵硬 */\r\n    private _stiff = false;\r\n\r\n\r\n    get stiff(): boolean {\r\n        return this._stiff;\r\n    }\r\n\r\n    set stiff(value: boolean) {\r\n        this._stiff = value;\r\n        this.playStand();\r\n    }\r\n\r\n    doStiff(stiff:number){\r\n        this.stiff = true;\r\n        let action = cc.sequence(cc.delayTime(stiff), cc.callFunc(()=>this.stiff = false));\r\n        action.setTag(1230);\r\n        this.node.stopActionByTag(1230);\r\n        this.node.runAction(action);\r\n    }\r\n\r\n    doSpeedcut(){\r\n        if (this.speedcut > 0){\r\n            this.speedAdd = 1 - this.speedcut;\r\n            let action = cc.sequence(cc.delayTime(0.15), cc.callFunc(()=>this.speedAdd = 1));\r\n            action.setTag(2510);\r\n            this.node.stopActionByTag(2510);\r\n            this.node.runAction(action);\r\n        }\r\n    }\r\n\r\n    doRepel(dir:cc.Vec2, repel:number){\r\n        this.playBeaten();\r\n        /** 计算与边线线段的交点 */\r\n        let delta = dir.mul(repel);\r\n        let destPos = this.node.position.add(delta);\r\n        let intersections = [];\r\n        if (dir.x > 0){\r\n            //右边界\r\n            if (destPos.x >= this._bounds.xMax){\r\n                let point = cc.v2();\r\n                if(cc.Intersection.pLineIntersect(this.node.position, destPos, cc.v2(this._bounds.xMax, this._bounds.yMin), cc.v2(this._bounds.xMax, this._bounds.yMax), point)){\r\n                    intersections.push(point);\r\n                }\r\n            }\r\n        }else if (dir.x < 0) {\r\n            //左边界\r\n            if (destPos.x <= this._bounds.xMin){\r\n                let point = cc.v2();\r\n                if(cc.Intersection.pLineIntersect(this.node.position, destPos, cc.v2(this._bounds.xMin, this._bounds.yMin), cc.v2(this._bounds.xMin, this._bounds.yMax), point)){\r\n                    intersections.push(point);\r\n                }\r\n            }\r\n        }\r\n\r\n        if (dir.y > 0){\r\n            //上边界\r\n            if (destPos.y >= this._bounds.yMax){\r\n                let point = cc.v2();\r\n                if(cc.Intersection.pLineIntersect(this.node.position, destPos, cc.v2(this._bounds.xMin, this._bounds.yMax), cc.v2(this._bounds.xMax, this._bounds.yMax), point)){\r\n                    intersections.push(point);\r\n                }\r\n            }\r\n        }else if (dir.y < 0){\r\n            //上边界\r\n            if (destPos.y <= this._bounds.yMin){\r\n                let point = cc.v2();\r\n                if(cc.Intersection.pLineIntersect(this.node.position, destPos, cc.v2(this._bounds.xMin, this._bounds.yMin), cc.v2(this._bounds.xMax, this._bounds.yMin), point)){\r\n                    intersections.push(point);\r\n                }\r\n            }\r\n        }\r\n\r\n        if (intersections.length > 0){\r\n            // console.log(\"重新计算destPos===>intersections\", intersections);\r\n            /** 重新计算destPos */\r\n            if (intersections.length == 1){\r\n                destPos = intersections[0].addSelf(dir.neg(cc.v2()));\r\n            } else {\r\n                /** 取距离怪物最近的那个点 */\r\n                let p = intersections[0];\r\n                let minDistance = p.sub(this.node.position).mag();\r\n                for (let i=1; i<intersections.length; i++){\r\n                    let mag = intersections[i].sub(this.node.position).mag();\r\n                    if (mag < minDistance){\r\n                        p = intersections[i];\r\n                        minDistance = mag;\r\n                    }\r\n                }\r\n                destPos = p.addSelf(dir.neg(cc.v2()));\r\n            }\r\n        }\r\n        let distance = destPos.sub(this.node.position).mag();\r\n        let speed = 800;\r\n        let action = cc.sequence(cc.moveTo(distance/speed, destPos).easing(cc.easeCircleActionOut()), cc.callFunc(()=>{\r\n            this.playBeatenBack();\r\n        }));\r\n        action.setTag(582);\r\n        this.node.stopActionByTag(582);\r\n        this.node.runAction(action);\r\n    }\r\n\r\n    private _hp = 0;\r\n\r\n    get hp(): number {\r\n        return this._hp;\r\n    }\r\n\r\n    set hp(value: number) {\r\n        if (this._hp <= 0)return;\r\n        let damage = this._hp - value;\r\n        window['GameLabelsController'] .fly(`-${ext.shortFormat(damage)}`, this.node.position.add(cc.v2(0, this.spaceCircleCollider.radius)));\r\n        this.ske.node.color = this.ske.node.color.fromHEX(\"#D85959\");\r\n        this.ske.node.runAction(cc.sequence(cc.delayTime(0.05), cc.callFunc(()=>this.ske.node.color = cc.Color.WHITE)));\r\n        this._hp = value;\r\n        if (value <= 0){\r\n            GameProxy.killCount++;\r\n            GameProxy.emit(GameProxy.Event.KillEnemy, this);\r\n            this.node.stopAllActions();\r\n            this._stiff = true;\r\n            this.playDead();\r\n        }\r\n    }\r\n\r\n    hurt = 0;\r\n\r\n    hierarchy = 0;\r\n\r\n    /** 综合属性 */\r\n\r\n    /** 敏捷度 */\r\n    agility = 0;\r\n\r\n    private _strikeCompleteTime = 0;\r\n\r\n\r\n    get strikeCompleteTime(): number {\r\n        return this._strikeCompleteTime;\r\n    }\r\n\r\n    private _spaceCircleCollider:cc.CircleCollider = null;\r\n\r\n    private _defenceBoxCollider:cc.BoxCollider = null;\r\n\r\n\r\n    get spaceCircleCollider(): cc.CircleCollider {\r\n        return this._spaceCircleCollider;\r\n    }\r\n\r\n    get defenceBoxCollider(): cc.BoxCollider {\r\n        return this._defenceBoxCollider;\r\n    }\r\n\r\n    private _enemyAABB:EnemyAABB = null;\r\n\r\n\r\n    get enemyAABB(): EnemyAABB {\r\n        return this._enemyAABB;\r\n    }\r\n\r\n    private _bounds = cc.rect();\r\n\r\n    reset(){\r\n        this._hp = this.maxHp;\r\n        this.stiff = false;\r\n        this.speedAdd = 1;\r\n        this.gameSlow = GameProxy.slowGame;\r\n        this._bAcc = false;\r\n        if (GameProxy.maxEnemyNum - GameProxy.enemyList.length  >= GameProxy.levelConfig.amount_p1+1){\r\n            this.bAcc = true;\r\n        }\r\n        this.ske.timeScale = BASE_TIME_SCALE;\r\n        this.moveFlag = false;\r\n        this.lookAtRoleFlag = false;\r\n        this.attackCoolingFlag = false;\r\n        this.logicFlag = false;\r\n        this.node.on(cc.Node.EventType.ROTATION_CHANGED, ()=>{\r\n            this.moveDir = cc.v2(0, 1).normalize().rotate(cc.misc.degreesToRadians(-this.node.rotation));\r\n        });\r\n        /** 朝向角色 */\r\n        let dir = window['GameRoleController'].role.node.position.sub(this.node.position);\r\n        this.node.rotation = 90 - cc.misc.radiansToDegrees(Math.atan2(dir.y, dir.x));\r\n        this.playStand();\r\n    }\r\n\r\n    onEnable(){\r\n        this.reset();\r\n    }\r\n\r\n    onDisable(){\r\n        this.node.stopAllActions();\r\n    }\r\n\r\n    start(){\r\n        let bgNode = this.node.getParent().getParent();\r\n        this._bounds.x = -bgNode.width/2 + this.spaceCircleCollider.radius;\r\n        this._bounds.y = -bgNode.height/2 + this.spaceCircleCollider.radius;\r\n        this._bounds.width = bgNode.width - this.spaceCircleCollider.radius*2;\r\n        this._bounds.height = bgNode.height - this.spaceCircleCollider.radius*2;\r\n    }\r\n\r\n    onLoad(){\r\n        this._spaceCircleCollider = this.getComponent(cc.CircleCollider);\r\n        this._defenceBoxCollider = this.getComponent(cc.BoxCollider);\r\n        this._enemyAABB = this.getComponent(EnemyAABB);\r\n        this.ske.setMix(\"strike\", \"stand\", 0.1);\r\n        this.ske.setMix(\"walk\", \"strike\", 0.1);\r\n        this.ske.setCompleteListener((trackEntry, loopCount) => {\r\n            let name = trackEntry.animation ? trackEntry.animation.name : '';\r\n            if (name == \"strike\") {\r\n                this.playStand();\r\n                this._strikeCompleteTime = new Date().getTime();\r\n                this.attackCoolingFlag = true;\r\n                this.node.runAction(cc.sequence(cc.delayTime(this.attackCD), cc.callFunc(()=>{\r\n                    this.attackCoolingFlag = false;\r\n                })));\r\n            }else if (name == \"beaten\"){\r\n                this.playStand();\r\n            }else if (name == \"dead\"){\r\n                this.showBlood();\r\n                this.node.runAction(cc.sequence(cc.delayTime(0), cc.callFunc(()=>{\r\n                    this.node.active = false;\r\n                })));\r\n            }else if (name == \"stand\"){\r\n                this.playWalk();\r\n            }\r\n        });\r\n    }\r\n\r\n    private showBlood(){\r\n        let bloodNode = window['GameEnemysController'].getInactiveEnemyBloodNode();\r\n        bloodNode.active = true;\r\n        bloodNode.position = this.node.position;\r\n        bloodNode.rotation = Math.random()*360;\r\n        bloodNode.scale = this.humorScale;\r\n        bloodNode.opacity = 255;\r\n        bloodNode.runAction(cc.sequence(cc.delayTime(1), cc.fadeTo(0.5, 60), cc.callFunc(()=>{\r\n            bloodNode.active =false;\r\n        })));\r\n    }\r\n\r\n    isInAttackRange():boolean{\r\n        let sub = window['GameRoleController'].role.node.position.sub(this.node.position);\r\n        let distance = sub.mag();\r\n        //并且打不到敌人\r\n\r\n        if (distance < this.attackDistance + window['GameRoleController'].role.spaceCircleCollider.radius){\r\n            // console.log(\"===============>怪物可以攻击了\");\r\n            /** 根据攻击距离计算攻击夹角 */\r\n            let attackRadian = Math.atan(window['GameRoleController'].role.spaceCircleCollider.radius/distance);\r\n            if (sub.angle(cc.v2(0, 1).rotate(cc.misc.degreesToRadians(-this.node.rotation))) < attackRadian){\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    protected doAttack(){\r\n        /** 判断攻击角度与距离，在一定范围内则判断为攻击成功 */\r\n        if (this.isInAttackRange()){\r\n            Music.playSFX(\"sound/msc_en003\");\r\n            window['GameRoleController'].hp -= this.hurt;\r\n        }\r\n    }\r\n\r\n    protected _enemyID = 0;\r\n\r\n\r\n    get enemyID(): number {\r\n        return this._enemyID;\r\n    }\r\n\r\n    init(id:number){\r\n        this._enemyID = id;\r\n        let config = ExcelConfig.getExcelTable(ExcelTableNames.Enemy)[id-1];\r\n        this.unrepel = config['unrepel'];\r\n        this._moveSpeed = config['move'];\r\n        this.accSpeed = config['acc_s'];\r\n        this.foundRange = config['found_rg'];\r\n        this.agility = config['agility'];\r\n        this.attackDistance = config['range'];\r\n        this.attackCD = config['fre'];\r\n        this.bulletSpeed = config['speed'];\r\n        this.maxHp = this._hp = Math.floor(config['health']*GameProxy.enemyHpMulOf(this._enemyID));\r\n        this.hurt = Math.floor(config['hurt'] * GameProxy.enemyHurtMulOf(config['id']));\r\n        this.hierarchy = config['hierarchy'];\r\n        this.humorScale = config['humor'];\r\n        this.gold = Math.floor(config['gold_pro'] * GameProxy.enemyGoldMulOf(this._enemyID));\r\n        this.goldIconFell = config['gold_fell'];\r\n        this.speedcut = config['speedcut'];\r\n        this.node.zIndex = this.hierarchy;\r\n        this.attackDelayTime = AttackDelayList[id-1];\r\n        if (id > AttackDelayList.length){\r\n            console.error(\"_enemyID > AttackDelayList.length\");\r\n        }\r\n    }\r\n\r\n    protected setAnimation(trackIndex:number, name:string, loop:boolean){\r\n        this.ske.setAnimation(trackIndex, name, loop);\r\n        this.moveFlag =  name == \"walk\";\r\n        this.lookAtRoleFlag = name != \"strike\";\r\n    }\r\n\r\n    private attackDelayTime = -1;\r\n\r\n    stopAttack(){\r\n        this.node.stopActionByTag(1199);\r\n    }\r\n\r\n    playStand(){\r\n        this.setAnimation(0, \"stand\", true);\r\n    }\r\n\r\n    playAttack(){\r\n        if (this.attackDelayTime >= 0){\r\n            let action = cc.speed(cc.sequence(cc.delayTime(this.attackDelayTime), cc.callFunc(()=>{\r\n                if (!GameProxy.pauseGame){\r\n                    this.doAttack();\r\n                }\r\n            })), 1);\r\n            action.setTag(1199);\r\n            this.node.runAction(action);\r\n        }\r\n        this.setAnimation(0, \"strike\", false);\r\n    }\r\n\r\n    playWalk(){\r\n        this.setAnimation(0, \"walk\", true);\r\n    }\r\n\r\n    playDead(){\r\n        this.stopAttack();\r\n        this.ske.timeScale = BASE_TIME_SCALE;\r\n        this.setAnimation(0, \"dead\", false);\r\n    }\r\n\r\n    playBeaten(){\r\n        this.stopAttack();\r\n        // console.log(\"beaten2.....\");\r\n        this.setAnimation(0, \"beaten2\", false);\r\n    }\r\n\r\n    playBeatenBack(){\r\n        // console.log(\"beaten.....\");\r\n        this.setAnimation(0, \"beaten\", false);\r\n    }\r\n\r\n    isAttacking(){\r\n        return this.ske.animation == \"strike\";\r\n    }\r\n\r\n    isBeating(){\r\n        return this.ske.animation == \"beaten2\" || this.ske.animation == \"beaten\";\r\n    }\r\n\r\n    isWalking(){\r\n        return this.ske.animation == \"walk\";\r\n    }\r\n\r\n    isStanding(){\r\n        return this.ske.animation == \"stand\";\r\n    }\r\n\r\n    isDead(){\r\n        return this._hp <=0;\r\n    }\r\n\r\n    turnTo(dir:cc.Vec2){\r\n        let degree = (90 - cc.misc.radiansToDegrees(Math.atan2(dir.y, dir.x)))%360;\r\n        // console.log(\"de===>\", degree);\r\n        // console.log(\"dir===>x=\"+dir.x+\" y=\"+dir.y);\r\n        if (degree < 0){\r\n            degree += 360;\r\n        }\r\n        let enemyRotation = this.node.rotation%360;\r\n        if (enemyRotation < 0){\r\n            enemyRotation += 360;\r\n        }\r\n        let subDegree = Math.abs(degree - enemyRotation);\r\n        // console.log(\"degree=\"+degree);\r\n        // console.log(\"enemyRotation====>\"+enemyRotation);\r\n        let speed = this._moveSpeed*this.agility*(this._bAcc?0.5:1) * this._speedAdd * (this._gameSlow?0.2:1);\r\n        if (subDegree > 0){\r\n            let rotation = 0;\r\n            if (subDegree > 180){\r\n                rotation = Math.sign(enemyRotation - degree) * speed;\r\n                if (Math.abs(rotation) > 360 - subDegree){\r\n                    rotation = Math.sign(rotation)*(360-subDegree);\r\n                }\r\n            }else {\r\n                rotation = Math.sign(degree - enemyRotation) * speed;\r\n                if (Math.abs(rotation) > subDegree){\r\n                    rotation = Math.sign(rotation) * subDegree;\r\n                }\r\n            }\r\n            enemyRotation += rotation;\r\n        }\r\n        this.node.rotation = enemyRotation;\r\n    }\r\n\r\n    move(){\r\n        // console.log(\"len===>\", len);\r\n        let len = this.moveSpeed;\r\n        if (len <= 0)return false;\r\n        /** 沿着当前方向移动 */\r\n        let position = this.node.position.add(this.moveDir.mul(len));\r\n        /** 判断与角色的碰撞 */\r\n        // let toRoleDistance = position.sub(window['GameRoleController'].role.node.position).mag();\r\n        // if (toRoleDistance < this.spaceCircleCollider.radius + window['GameRoleController'].role.spaceCircleCollider.radius){\r\n        //     return false;\r\n        // }\r\n\r\n        /** 判断边界 */\r\n        if (position.x > this._bounds.xMax || position.x < this._bounds.xMin || position.y > this._bounds.yMax || position.y < this._bounds.yMin){\r\n            return false;\r\n        }\r\n\r\n        if (!this._bAcc && this.foundRange > 0){\r\n            let toRoleDistance = position.sub(window['GameRoleController'].role.node.position).mag();\r\n            this.bAcc = toRoleDistance - len < this.foundRange;\r\n        }\r\n\r\n        /** 判断怪物之间的碰撞 */\r\n        // let arr = [];\r\n        // this._gameCollisionController.looseQuadTree.retrieve(this.enemyAABB.aabb(),arr);\r\n        //\r\n        // for (let aabbRegion of arr){\r\n        //     let enemy = aabbRegion.enemy;\r\n        //     if (enemy !== this && enemy.node.position.sub(position).mag() < enemy.spaceCircleCollider.radius + enemy.spaceCircleCollider.radius){\r\n        //         return false;\r\n        //     }\r\n        // }\r\n\r\n        this.node.position = position;\r\n        return true;\r\n    }\r\n\r\n    update(dt:number){\r\n        if (GameProxy.pauseGame || this.stiff){\r\n            return;\r\n        }\r\n        /** 逻辑处理标志--优化策略为每一帧只处理固定数量的怪物逻辑 */\r\n        if (this.logicFlag){\r\n            /** 是否可以攻击 */\r\n            if ((this.isWalking() || this.isStanding()) && this.isInAttackRange()){\r\n                this.playAttack();\r\n            }\r\n\r\n            /** 旋转 */\r\n            if (this.lookAtRoleFlag){\r\n                this.turnTo(window['GameRoleController'].role.node.position.sub(this.node.position).normalize());\r\n            }\r\n        }\r\n        /** 移动 */\r\n        if (this.moveFlag){\r\n            this.move();\r\n        }\r\n    }\r\n}\r\n"]}