{"version":3,"sources":["assets/script/app/home/EarningsLayerController.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\nimport {World} from \"../info/World\";\r\nimport {NetworkConfig} from \"../config/NetworkConfig\";\r\nimport Network from \"../network/Network\";\r\nimport {ext} from \"../../../framework/extend/Extend\";\r\nimport {ExcelConfig} from \"../../../framework/config/ExcelConfig\";\r\nimport {ExcelTableNames} from \"../config/ExcelTableNames\";\r\nimport Facade from \"../../../framework/facade/Facade\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class EarningsLayerController extends cc.Component {\r\n\r\n    @property(cc.RichText)\r\n    goldLvLabel: cc.RichText = null;\r\n\r\n    @property(cc.RichText)\r\n    dayEarnLvLabel: cc.RichText = null;\r\n\r\n    @property(cc.RichText)\r\n    goldCostLabel: cc.RichText = null;\r\n\r\n    @property(cc.RichText)\r\n    dayEarnCostLabel: cc.RichText = null;\r\n\r\n    @property(cc.RichText)\r\n    goldWorthLabel:cc.RichText = null;\r\n\r\n    @property(cc.RichText)\r\n    dayEarnWorthLabel:cc.RichText = null;\r\n\r\n    @property(cc.Button)\r\n    goldLvButton:cc.Button = null;\r\n\r\n    @property(cc.Button)\r\n    dayEarnButton:cc.Button = null;\r\n\r\n    onLoad () {\r\n        this.updateGoldUp();\r\n        this.updateDayEarnUp();\r\n        cc.find('Canvas').on(\"UpdateStorage\", this.onUpdateStorageEvent, this);\r\n    }\r\n\r\n    onDestroy(){\r\n        cc.find('Canvas').off(\"UpdateStorage\", this.onUpdateStorageEvent, this);\r\n    }\r\n\r\n    onUpdateStorageEvent(key:string){\r\n        if (key == \"goldCount\"){\r\n            let cfg = ExcelConfig.getExcelTable(ExcelTableNames.GoldUp);\r\n            if (World.Storage.goldLv < cfg.length){\r\n                let needCost = cfg[World.Storage.goldLv-1]['gvalue_expend'];\r\n                this.goldLvButton.interactable = World.Storage.goldCount >= needCost;\r\n                this.goldCostLabel.node.color = this.goldLvButton.interactable?cc.Color.WHITE:cc.Color.RED.fromHEX(\"#924338\");\r\n            }\r\n            if (World.Storage.dayEarnLv < cfg.length){\r\n                let needCost = cfg[World.Storage.dayEarnLv-1]['on_hook_expend'];\r\n                this.dayEarnButton.interactable = World.Storage.goldCount >= needCost;\r\n                this.dayEarnCostLabel.node.color = this.dayEarnButton.interactable?cc.Color.WHITE:cc.Color.RED.fromHEX(\"#924338\");\r\n            }\r\n        }\r\n    }\r\n\r\n    updateGoldUp(){\r\n        let cfg = ExcelConfig.getExcelTable(ExcelTableNames.GoldUp);\r\n        this.goldLvLabel.string = `<b><outline color=#1e1e1e width=4>金币价值Lv.${World.Storage.goldLv}</outline></b>`;\r\n        if (World.Storage.goldLv >= cfg.length){\r\n            this.goldCostLabel.string = `<b><outline color=#1e1e1e width=3>满级</outline></b>`;\r\n            this.goldLvButton.interactable = false;\r\n        }else {\r\n            let needCost = cfg[World.Storage.goldLv-1]['gvalue_expend'];\r\n            this.goldCostLabel.string = `<b><outline color=#1e1e1e width=3>${ext.shortFormat(needCost)}</outline></b>`;\r\n            this.goldLvButton.interactable = World.Storage.goldCount >= needCost;\r\n        }\r\n        this.goldCostLabel.node.color = this.goldLvButton.interactable?cc.Color.WHITE:cc.Color.RED.fromHEX(\"#924338\");\r\n        this.goldWorthLabel.string = `<b><outline color=#1e1e1e width=3>${Math.floor(cfg[World.Storage.goldLv-1]['gvalue']*100)}%</outline></b>`;\r\n    }\r\n\r\n    updateDayEarnUp(){\r\n        let cfg = ExcelConfig.getExcelTable(ExcelTableNames.GoldUp);\r\n        this.dayEarnLvLabel.string = `<b><outline color=#1e1e1e width=4>日常收益Lv.${World.Storage.dayEarnLv}</outline></b>`;\r\n        if (World.Storage.dayEarnLv >= cfg.length){\r\n            this.dayEarnCostLabel.string = `<b><outline color=#1e1e1e width=3>满级</outline></b>`;\r\n            this.dayEarnButton.interactable = false;\r\n        }else {\r\n            let needCost = cfg[World.Storage.dayEarnLv-1]['on_hook_expend'];\r\n            this.dayEarnCostLabel.string = `<b><outline color=#1e1e1e width=3>${ext.shortFormat(needCost)}</outline></b>`;\r\n            this.dayEarnButton.interactable = World.Storage.goldCount >= needCost;\r\n        }\r\n\r\n        this.dayEarnCostLabel.node.color = this.dayEarnButton.interactable?cc.Color.WHITE:cc.Color.RED.fromHEX(\"#924338\");\r\n        this.dayEarnWorthLabel.string = `<b><outline color=#1e1e1e width=3>${ext.shortFormat(cfg[World.Storage.dayEarnLv-1]['on_hook'])}</outline></b>`;\r\n    }\r\n\r\n    onClickUpGoldLv(event, data){\r\n        console.log(\"【click】EarningsLayerController UpGoldLv\")\r\n        \r\n        let cfg = ExcelConfig.getExcelTable(ExcelTableNames.GoldUp);\r\n        let needCost = cfg[World.Storage.goldLv-1]['gvalue_expend'];\r\n        World.Storage.goldCount -= needCost;\r\n        World.Storage.goldLv++;\r\n        this.updateGoldUp();\r\n        Facade.canvasNode.emit(\"GoldWorthUp\");\r\n    }\r\n\r\n    onClickUpDayEarnLv(event, data){\r\n        console.log(\"【click】EarningsLayerController UpDayEarnLv\")\r\n\r\n        let cfg = ExcelConfig.getExcelTable(ExcelTableNames.GoldUp);\r\n        let needCost = cfg[World.Storage.dayEarnLv-1]['on_hook_expend'];\r\n        World.Storage.dayEarnLv++;\r\n        World.Storage.goldCount -= needCost;\r\n        this.updateDayEarnUp();\r\n        Facade.canvasNode.emit(\"GoldDayEarnUp\");\r\n    }\r\n}\r\n"]}