{"version":3,"sources":["assets/framework/tableview/TableViewMediator.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n/**\r\n * 使用TableView注意事项:\r\n * 1.设置mask 设置锚点(0, 1)  添加widget并设置top bottom left right都为0\r\n * 2.设置content 设置锚点(0, 1)  添加widget并设置top left right都为0\r\n * 3.设置itemNode  设置大小(w,h)　设置锚点(0, 0.5)\r\n * **/\r\n\r\nimport AbstractTableItem from \"./AbstractTableItem\";\r\n\r\nconst {ccclass, property,menu, requireComponent, disallowMultiple, executionOrder} = cc._decorator;\r\n\r\n@ccclass\r\n@menu(\"自定义/TableViewMediator\")\r\n@requireComponent(cc.ScrollView)\r\n@disallowMultiple\r\n@executionOrder(-10)\r\nexport default class TableViewMediator extends cc.Component {\r\n\r\n    scrollView:cc.ScrollView = null;\r\n\r\n    @property(AbstractTableItem)\r\n    template:AbstractTableItem = null;\r\n\r\n    @property({type:cc.Integer})\r\n    marginTop = 0;\r\n\r\n    @property({type:cc.Integer})\r\n    marginBottom = 0;\r\n\r\n    @property({type:cc.Integer})\r\n    margin = 0;\r\n\r\n    @property\r\n    testNum = 0;\r\n\r\n    @property\r\n    itemAction:boolean = false;\r\n\r\n\r\n    private itemHeight = 0;\r\n\r\n    list:Array<cc.Node> = [];\r\n\r\n    private firstIndex = 0;\r\n\r\n    private firstIndexMax = 0;\r\n\r\n    private _datas = [];\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    private createNodesFinish = false;\r\n\r\n    private createNodesListener(listener:()=>void){\r\n        if (this.createNodesFinish){\r\n            listener();\r\n        }else {\r\n            this.node.on(\"CreateNodesSuccess\", ()=>{\r\n                listener();\r\n            });\r\n        }\r\n    }\r\n\r\n    get datas(): any[] {\r\n        return this._datas;\r\n    }\r\n\r\n    set datas(value: any[]) {\r\n        /** 计算最大firstIndexMax */\r\n        this.createNodesListener(()=>{\r\n            let num = Math.ceil((this.scrollView.node.getContentSize().height - this.marginTop - this.marginBottom + this.margin) / (this.itemHeight+this.margin));\r\n            this.firstIndexMax = value.length - num - 1;\r\n            // console.log(this.firstIndexMax,datas.length, this.list.length, num, \"wxSub this.firstIndexMax************\");\r\n\r\n            this._datas = value.slice(0);\r\n            // this.datas = [1,2,3,4,5,6,7,8,9];\r\n            this.scrollView.content.height = this.marginTop + this.marginBottom + this.itemHeight * this._datas.length + this.margin * (this._datas.length - 1);\r\n            this.firstIndex = 0;\r\n            this.scrollView.scrollToTop();\r\n            this.list.forEach((value1, index) => {\r\n                value1.y = -this.marginTop - value1.height/2 - index * (value1.height + this.margin);\r\n                if (index >= this._datas.length){\r\n                    value1.active = false;\r\n                }\r\n            });\r\n            this.updateData();\r\n            if (this.itemAction){\r\n                this.showAction();\r\n            }\r\n        });\r\n    }\r\n\r\n    private createNode(){\r\n        let node = cc.instantiate(this.template.node);\r\n        node.active = false;\r\n        this.itemHeight = node.getContentSize().height;\r\n        node.x = 0;\r\n        node.setParent(this.scrollView.content);\r\n        this.list.push(node);\r\n        return node;\r\n    }\r\n\r\n    private addNode(height:number){\r\n        if (height <= this.scrollView.node.getContentSize().height){\r\n            this.node.runAction(cc.sequence(cc.delayTime(0), cc.callFunc(()=>{\r\n                let node = this.createNode();\r\n                node.y = -height - this.itemHeight/2;\r\n                height += this.itemHeight + this.margin;\r\n                this.addNode(height);\r\n            })));\r\n        }else {\r\n            let node = this.createNode();\r\n            node.y = -height - this.itemHeight/2;\r\n            let eventHandler = new cc.Component.EventHandler();\r\n            eventHandler.target = this.node; //这个 node 节点是你的事件处理代码组件所属的节点\r\n            eventHandler.component = \"TableViewMediator\";\r\n            eventHandler.handler = \"onScrollEvent\";\r\n            eventHandler.customEventData = \"\";\r\n            this.scrollView.scrollEvents.push(eventHandler);\r\n            if (!this.createNodesFinish){\r\n                this.createNodesFinish = true;\r\n                this.node.emit(\"CreateNodesSuccess\");\r\n            }\r\n        }\r\n    }\r\n\r\n    onLoad(){\r\n        this.scrollView = this.node.getComponent(cc.ScrollView);\r\n        // let eventHandler = new cc.Component.EventHandler();\r\n        // eventHandler.target = this.node; //这个 node 节点是你的事件处理代码组件所属的节点\r\n        // eventHandler.component = \"TableViewMediator\";\r\n        // eventHandler.handler = \"onScrollEvent\";\r\n        // eventHandler.customEventData = \"\";\r\n        // this.scrollView.scrollEvents.push(eventHandler);\r\n        // let itemNode = cc.instantiate(this.template.node);\r\n        // itemNode.active = false;\r\n        // this.itemHeight = itemNode.getContentSize().height;\r\n        // let itemHeightHalf = this.itemHeight/2;\r\n        // /** 计算出view能装下多少个item */\r\n        // let viewSize = this.scrollView.node.getContentSize();\r\n        // let content = this.scrollView.content;\r\n        //\r\n        // let height = this.marginTop;\r\n        // while (true){\r\n        //     if (height > viewSize.height){\r\n        //         break;\r\n        //     }\r\n        //\r\n        //     let node = cc.instantiate(itemNode);\r\n        //     node.x = 0;\r\n        //     node.y = -height - itemHeightHalf;\r\n        //     node.setParent(content);\r\n        //     this.list.push(node);\r\n        //     height += this.itemHeight + this.margin;\r\n        //     // console.log(\"wx sub===>node.y\", node.y);\r\n        // }\r\n        //\r\n        // itemNode.x = 0;\r\n        // itemNode.y = -height - itemHeightHalf;\r\n        // itemNode.setParent(content);\r\n        // this.list.push(itemNode);\r\n        this.addNode(this.marginTop);\r\n\r\n        /** 延迟判断 */\r\n        // let self = this;\r\n        // this.scheduleOnce(function () {\r\n        //     self._adjustList();\r\n        // }, 0.1);\r\n        if (this.testNum > 0){\r\n            let test = [];\r\n            for (let i=0; i<this.testNum; i++){\r\n                test.push(i+1);\r\n            }\r\n            this.datas = test;\r\n        }\r\n    }\r\n\r\n    _adjustList(){\r\n        let viewSize = this.scrollView.node.getContentSize();\r\n        let content = this.scrollView.content;\r\n        let itemHeightHalf = this.itemHeight/2;\r\n        let height = this.marginTop + (this.itemHeight + this.margin) * this.list.length  - this.margin;\r\n        while (height < viewSize.height + this.itemHeight){\r\n            let node = cc.instantiate(this.template.node);\r\n            node.active = false;\r\n            node.x = 0;\r\n            node.y = -height - itemHeightHalf;\r\n            node.setParent(content);\r\n            this.list.push(node);\r\n            height += this.itemHeight + this.margin;\r\n            if (this._datas.length >= this.list.length){\r\n                let index = this.list.length-1;\r\n                let value =this.list[index];\r\n                value.active = true;\r\n                this.updateItem(value, index);\r\n            }\r\n        }\r\n        if (this._datas.length > 0){\r\n            let num = Math.ceil((viewSize.height - this.marginTop - this.marginBottom + this.margin) / (this.itemHeight+this.margin));\r\n            this.firstIndexMax = this._datas.length - num - 1;\r\n        }\r\n    }\r\n\r\n    updateData(){\r\n        let arr = this.list.slice(0, Math.min(this._datas.length, this.list.length));\r\n        this.updateItems(arr, 0);\r\n    }\r\n\r\n    showAction(){\r\n        this.list.slice(0, Math.min(this._datas.length, this.list.length)).forEach((value, index) => {\r\n            value.scaleX = 0;\r\n            if (value.active){\r\n                value.runAction(cc.scaleTo(0.3+(0.08*index), 1).easing(cc.easeCubicActionInOut()));\r\n            } else {\r\n                let comp = value.addComponent(cc.Component);\r\n                comp['onEnable'] = ()=>{\r\n                    value.runAction(cc.scaleTo(0.3+(0.08*index), 1).easing(cc.easeCubicActionInOut()));\r\n                };\r\n                comp['onDisable'] = ()=>{\r\n                    comp.destroy();\r\n                };\r\n            }\r\n        });\r\n    }\r\n\r\n    private updateItems(arr:Array<cc.Node>, index:number){\r\n        if (index < arr.length){\r\n            this.node.runAction(cc.sequence(cc.delayTime(0), cc.callFunc(()=>{\r\n                let node = arr[index];\r\n                node.active = true;\r\n                this.updateItem(node, this.firstIndex+index);\r\n                this.updateItems(arr, index+1);\r\n            })));\r\n        }\r\n    }\r\n\r\n    updateItem(node:cc.Node, index:number){\r\n        let value = this._datas[index];\r\n        let itemMediator = node.getComponent(AbstractTableItem);\r\n        itemMediator.upadteItem(value, index);\r\n    }\r\n\r\n    private onScrollEvent(event){\r\n        // console.log(event, \"event\");\r\n        let content = this.scrollView.content;\r\n        // let contentHeight = content.getContentSize().height;\r\n        let viewHeight = this.scrollView.node.getContentSize().height;\r\n        /*if ((!this.scrollView.isAutoScrolling() && !this.scrollView.isScrolling()) || content.y < 0 || content.y >= contentHeight - viewHeight){\r\n            return;\r\n        }*/\r\n        let contentY = content.y;\r\n        // console.log(contentY, \"contentY\");\r\n        /** 判断第1个元素 和 倒数第1个元素的位置 */\r\n        /** 上边界 */\r\n        let itemHeightHalf = this.itemHeight/2;\r\n\r\n        /** 头插入 */\r\n        while(this.firstIndex > 0 && this.list[0].y + this.marginTop + itemHeightHalf < -contentY){\r\n            let last = this.list.pop();\r\n            last.y = this.list[0].y + this.itemHeight + this.margin;\r\n            this.list.unshift(last);\r\n            this.firstIndex--;\r\n            // console.log(\"===========>尾移头\");\r\n            this.updateItem(last, this.firstIndex);\r\n        }\r\n\r\n        /** 尾插入 */\r\n        while(this.firstIndex < this.firstIndexMax && this.list[this.list.length-1].y - itemHeightHalf - this.marginBottom > -contentY - viewHeight){\r\n            let first = this.list.shift();\r\n            first.y = this.list[this.list.length-1].y - this.itemHeight - this.margin;\r\n            this.list.push(first);\r\n            this.firstIndex++;\r\n            // console.log(\"===========>头移尾\", this.list[this.list.length-1].y);\r\n            this.updateItem(first, this.firstIndex+this.list.length-1);\r\n        }\r\n    }\r\n}\r\n"]}