{"version":3,"sources":["assets/script/app/interceptor/LoadSceneIntercetor.ts"],"names":[],"mappings":";;;;AAAA,oBAAoB;AACpB,iFAAiF;AACjF,yFAAyF;AACzF,mBAAmB;AACnB,2FAA2F;AAC3F,mGAAmG;AACnG,8BAA8B;AAC9B,2FAA2F;AAC3F,mGAAmG;;AAGnG,2DAAsD;AACtD,mDAAgD;AAChD,wDAAqD;AACrD,yDAAsD;AACtD,8CAAyC;AAEnC,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAAA;IA+CA,CAAC;IA7CG;;SAEK;IACC,uCAAS,GAAf;QAAgB,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;uCAAE,OAAO;;;gBAC5B,sBAAO,IAAI,OAAO,CAAC,UAAM,OAAO,EAAE,MAAM;;;;;oCAChC,SAAS,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;yCACpB,CAAA,SAAS,IAAI,WAAW,CAAA,EAAxB,wBAAwB;oCACxB,qBAAM,gBAAM,CAAC,cAAc,CAAC,yBAAyB,CAAC,EAAA;;oCAAtD,SAAsD,CAAC;;;oCACrD,IAAI,SAAS,IAAI,WAAW,EAAC;wCAC/B,IAAI,6BAAa,CAAC,aAAa,EAAC;4CAC5B,iBAAO,CAAC,WAAW,EAAE,CAAC;yCACzB;qCACJ;;;oCACD,OAAO,CAAC,IAAI,CAAC,CAAC;;;;yBACjB,CAAC,EAAC;;;KACN;IACD;;SAEK;IACC,wCAAU,GAAhB,UAAiB,GAAO;QAAE,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,6BAAO;;uCAAE,OAAO;;;gBACtC,sBAAO,IAAI,OAAO,CAAC,UAAO,OAAO,EAAE,MAAM;;;4BACjC,SAAS,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;4BACxB,IAAI,SAAS,IAAI,WAAW,EAAC;gCACzB,WAAW;gCACX,mCAAmC;gCACnC,kBAAkB;gCAElB,aAAa;gCACd;;;;;;6EAM6C;6BAE/C;iCAAK,IAAI,SAAS,IAAI,WAAW,EAAC;gCAC/B,WAAW;gCACX,aAAK,CAAC,MAAM,CAAC,uBAAU,CAAC,MAAM,CAAC,CAAC;6BACnC;iCAAK,IAAI,SAAS,IAAI,eAAe,EAAC;gCACnC,mBAAmB;6BACtB;4BACD,OAAO,EAAE,CAAC;;;yBACb,CAAC,EAAC;;;KACN;IA9CgB,mBAAmB;QADvC,OAAO;OACa,mBAAmB,CA+CvC;IAAD,0BAAC;CA/CD,AA+CC,IAAA;kBA/CoB,mBAAmB","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport {ICommandInterceptor} from \"../../../framework/interceptor/CommandInterceptor\";\r\nimport Facade from \"../../../framework/facade/Facade\";\r\nimport {MusicPaths} from \"../config/MusicPaths\";\r\nimport {Music} from \"../../../framework/audio/Music\";\r\nimport {NetworkConfig} from \"../config/NetworkConfig\";\r\nimport Network from \"../network/Network\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class LoadSceneIntercetor implements ICommandInterceptor {\r\n\r\n    /**\r\n     * 加载场景之前处理\r\n     * */\r\n    async preHandle(...args):Promise{\r\n        return new Promise(async(resolve, reject) => {\r\n            let sceneName = args[0];\r\n            if (sceneName == \"GameScene\"){\r\n                await Facade.executeCommand(\"PreloadGameSceneCommand\");\r\n            }else if (sceneName == \"HomeScene\"){\r\n                if (NetworkConfig.connectServer){\r\n                    Network.pushStorage();\r\n                }\r\n            }\r\n            resolve(true);\r\n        });\r\n    }\r\n    /**\r\n     * 加载场景完成之后处理\r\n     * */\r\n    async postHandle(res:any, ...args):Promise{\r\n        return new Promise(async (resolve, reject) => {\r\n            let sceneName = args[0];\r\n            if (sceneName == \"HomeScene\"){\r\n                /** 背景音乐 */\r\n                // Music.setBgm(MusicPaths.HomeBg);\r\n                /** 加载子工程好友排行数据 */\r\n\r\n                /** 显示新手引导 */\r\n               /* let prefab = await cc.loader.loadResAwait(\"prefab/newbie\", cc.Prefab);\r\n                let node = cc.instantiate(prefab);\r\n                let homeNode = Facade.canvasNode.getChildByName(\"HomeScene\");\r\n                let startGameNode = homeNode.getChildByName(\"startGame\");\r\n                node.position = startGameNode.position;\r\n                node.setParent(Facade.canvasNode);\r\n                LifeCycle.onDestroyFollow(node, homeNode);*/\r\n\r\n            }else if (sceneName == \"GameScene\"){\r\n                /** 背景音乐 */\r\n                Music.setBgm(MusicPaths.GameBg);\r\n            }else if (sceneName == \"GameOverScene\"){\r\n                // Music.stopBGM();\r\n            }\r\n            resolve();\r\n        });\r\n    }\r\n}\r\n"]}