{"version":3,"sources":["assets/script/app/game/GameController.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\nimport {GameProxy} from \"./GameProxy\";\r\nimport Enemy from \"../entities/enemy/Enemy\";\r\nimport {ext} from \"../../../framework/extend/Extend\";\r\nimport {World} from \"../info/World\";\r\nimport {Shake} from \"../../../framework/extend/Shake\";\r\nimport {ExcelConfig} from \"../../../framework/config/ExcelConfig\";\r\nimport {ExcelTableNames} from \"../config/ExcelTableNames\";\r\nimport {Music} from \"../../../framework/audio/Music\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class GameController extends cc.Component {\r\n    @property(cc.Animation)\r\n    moreEnemyTipsAnimation:cc.Animation = null;\r\n\r\n    @property(cc.Animation)\r\n    bossTipsAnimation:cc.Animation = null;\r\n\r\n    @property(cc.Node)\r\n    supplyGuideNode:cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    shakeNode:cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    topNode:cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    leftNode:cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    rightNode:cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    supplyNode:cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    greyNode:cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    blockNode:cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    reliveNode:cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    gameOverNode:cc.Node = null;\r\n\r\n\r\n    private _generating = false;\r\n\r\n    private _shakeDuration = 0;\r\n\r\n    onClickSupply(event,data){\r\n        console.log(\"【click】 GameControllerSupply\")\r\n\r\n        this.supplyNode.active = true;\r\n        let newbieNode = cc.director.getScene().getChildByName(\"newbieNode\");\r\n        if (newbieNode){\r\n            newbieNode.destroy();\r\n            World.My.newbies.finish(\"KillFiveEnemy\");\r\n        }\r\n    }\r\n\r\n    playEntry(){\r\n        let promises = [];\r\n        this.topNode.active = true;\r\n        this.topNode.y = cc.view.getVisibleSize().height/2 + 300;\r\n        let speed = 700;\r\n        let distance = this.topNode.y - cc.view.getVisibleSize().height/2;\r\n        if (ext.isIphoneX){\r\n            distance += 66;\r\n        }\r\n        promises.push(this.topNode.runActionAwait(cc.moveBy(distance/speed, cc.v2(0, -distance))));\r\n        this.leftNode.active = true;\r\n        this.leftNode.x = -cc.view.getVisibleSize().width/2-200;\r\n        promises.push(this.leftNode.runActionAwait(cc.moveTo(Math.abs(-cc.view.getVisibleSize().width/2 - this.leftNode.x)/speed, cc.v2(-cc.view.getVisibleSize().width/2, this.leftNode.y))));\r\n        this.rightNode.active = true;\r\n        this.rightNode.x = cc.view.getVisibleSize().width/2+200;\r\n        promises.push(this.rightNode.runActionAwait(cc.moveTo(Math.abs(cc.view.getVisibleSize().width/2 - this.rightNode.x)/speed, cc.v2(cc.view.getVisibleSize().width/2, this.rightNode.y))))\r\n        Promise.all(promises).then(res=>{\r\n            GameProxy.emit(GameProxy.Event.StartGame);\r\n            this.blockNode.active = false;\r\n        });\r\n    }\r\n\r\n    onLoad () {\r\n        this.supplyNode.active = false;\r\n        this.greyNode.active = true;\r\n        this.greyNode.opacity = 0;\r\n        this.reliveNode.active = false;\r\n        this.gameOverNode.active = false;\r\n        this.topNode.active = false;\r\n        this.leftNode.active = false;\r\n        this.rightNode.active = false;\r\n        this.blockNode.active = true;\r\n        this.node.on(GameProxy.Event.StartGenEnemy, this.startGenerating, this);\r\n        this.node.on(GameProxy.Event.StopGenEnemy, this.stopGenerating, this);\r\n        this.node.on(GameProxy.Event.KillEnemy, this.onKillEnemy, this);\r\n        this.node.on(GameProxy.Event.KillRole, this.onKillRole, this);\r\n        this.node.on(GameProxy.Event.SlowGame, this.onSlowGame, this);\r\n        this.node.on(GameProxy.Event.PauseGame, this.onPauseGame, this);\r\n        this.node.on(GameProxy.Event.ShakeScreen, this.onShakeScreen, this);\r\n        GameProxy.GameScene = this.node;\r\n        this.playEntry();\r\n    }\r\n\r\n    start(){\r\n        GameProxy.level = World.Storage.gameLevel;\r\n        GameProxy.slowGame = false;\r\n        GameProxy.pauseGame = false;\r\n        this._preDisplayGun = Math.random() * 100 > 50;\r\n        GameProxy.emit(GameProxy.Event.InitGame);\r\n        this._propList = ExcelConfig.getExcelTable(ExcelTableNames.Prop).filter(value => value['id'] != 7 && value['id'] != 8 && value['id'] != 10 && (value['unlock'] == 0 || World.My.propInfo.beUsing(value['id']))).map(value => value['id']);\r\n        this._gunsList = ExcelConfig.getExcelTable(ExcelTableNames.Weapon).filter(value => value['id'] != 1 && value['unlock'] <= World.Storage.gameLevel).map(value => value['id']);\r\n    }\r\n\r\n    onDestroy(){\r\n        this.node.off(GameProxy.Event.StartGenEnemy, this.startGenerating, this);\r\n        this.node.off(GameProxy.Event.StopGenEnemy, this.stopGenerating, this);\r\n        this.node.off(GameProxy.Event.KillEnemy, this.onKillEnemy, this);\r\n        this.node.off(GameProxy.Event.KillRole, this.onKillRole, this);\r\n        this.node.off(GameProxy.Event.SlowGame, this.onSlowGame, this);\r\n        this.node.off(GameProxy.Event.PauseGame, this.onPauseGame, this);\r\n        this.node.off(GameProxy.Event.ShakeScreen, this.onShakeScreen, this);\r\n    }\r\n\r\n    onShakeScreen(duration:number,strength_x:number,strength_y:number){\r\n        if (this._shakeDuration <= duration){\r\n            this._shakeDuration = duration;\r\n            this.shakeNode.stopAllActions();\r\n            this.shakeNode.position = cc.v2();\r\n            this.shakeNode.runAction(Shake.create(duration, strength_x, strength_y));\r\n        }\r\n    }\r\n\r\n    onSlowGame(slow:boolean){\r\n        // this.updateGrey();\r\n        window['GameEnemysController'].allActiveEnemy().forEach(value => value.gameSlow = slow);\r\n    }\r\n\r\n    onPauseGame(pause:boolean){\r\n        this.updateGrey();\r\n    }\r\n\r\n    updateGrey(opacity:number = 190){\r\n        console.log(\"updateGrey==>\", GameProxy.pauseGame);\r\n        this.greyNode.stopAllActions();\r\n        if (GameProxy.pauseGame || GameProxy.slowGame){\r\n            this.greyNode.runAction(cc.fadeTo(0.3, opacity));\r\n            // cc.tween(this.greyNode)\r\n            //     .to(0.3, { opacity: opacity })\r\n            //     .start();\r\n        }else {\r\n            this.greyNode.opacity = 0;\r\n        }\r\n    }\r\n\r\n    private _genEnemyCount = 0;\r\n\r\n    /**\r\n     * 启动怪物生成计划\r\n     */\r\n    startGenerating(){\r\n        if (this._generating)return;\r\n        this._generating = true;\r\n        // console.log(GameProxy.enemyList, \"enemyList\");\r\n        if (GameProxy.killCount < GameProxy.levelConfig.amount_p1){\r\n            /** 第一阶段 0.5s出一个怪物 */\r\n            /** 0.5s出一个怪物 */\r\n            let action = cc.sequence(cc.repeat(cc.sequence(cc.callFunc(()=>this._genEnemyCount += 1), cc.delayTime(0.5)), GameProxy.levelConfig.delimit_p1), cc.callFunc(()=>{\r\n                this._generating = false;\r\n                this.startCDTask();\r\n            }));\r\n            action.setTag(1010);\r\n            this.node.runAction(action);\r\n        }else {\r\n            /** 第二阶段 0.5s一次出3个 */\r\n            /** 0.5s出一个怪物 */\r\n            let action = cc.sequence(cc.repeat(cc.sequence(cc.callFunc(()=>this._genEnemyCount += 1), cc.delayTime(0.5)), Math.floor(GameProxy.levelConfig.delimit_p1)), cc.callFunc(()=>{\r\n                this._generating = false;\r\n                this.startCDTask();\r\n            }));\r\n            action.setTag(1010);\r\n            this.node.runAction(action);\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * 停止怪物生成计划\r\n     * */\r\n    stopGenerating(){\r\n        if (!this._generating)return;\r\n        this.node.stopActionByTag(1010);\r\n    }\r\n\r\n    /** 计时任务 */\r\n    startCDTask(){\r\n        this.stopCDTask();\r\n        let action = cc.sequence(cc.delayTime(10), cc.callFunc(()=>{\r\n            /** 生成两只怪物 */\r\n            this._genEnemyCount += 2;\r\n            this.startCDTask();\r\n        }));\r\n        action.setTag(1041);\r\n        this.node.runAction(action);\r\n    }\r\n\r\n    /** 停止计时任务 */\r\n    stopCDTask(){\r\n        this.node.stopActionByTag(1041);\r\n    }\r\n\r\n    onKillRole(){\r\n        GameProxy.isOver = true;\r\n        GameProxy.pauseGame = true;\r\n        if (GameProxy.firstAidFlag){\r\n            this.reliveNode.active = true;\r\n        } else {\r\n            this.reliveNode.active = true;\r\n        }\r\n        Music.playSFX(\"sound/msc_rol002\");\r\n        console.log(\"game over==>等待复活\");\r\n    }\r\n\r\n    private _propList = [1, 2, 3, 4, 5, 6, 9, 11, 12, 13];\r\n    private _gunsList = [];\r\n\r\n    private _displayPropList = [];\r\n    private _displayGusList = [];\r\n\r\n    /** 掉枪 */\r\n    private displayGun(position:cc.Vec2){\r\n        let prop = window['GameEnemysController'].getInactiveGun();\r\n        let testList = this._gunsList.filter(value => !this._displayGusList.includes(value));\r\n        if (testList.length == 0){\r\n            testList = this._gunsList;\r\n            this._displayGusList = [];\r\n        }\r\n        let id = ext.randomElement(testList);\r\n        this._displayGusList.push(id);\r\n        prop.init(id + 100);\r\n        prop.node.position = position;\r\n        prop.display();\r\n    }\r\n\r\n    /** 掉道具 */\r\n    private displayProp(position:cc.Vec2){\r\n        let testList = this._propList.filter(value => !this._displayPropList.includes(value));\r\n        if (testList.length == 0){\r\n            testList = this._propList;\r\n            this._displayPropList = [];\r\n        }\r\n        let id = ext.randomElement(testList);\r\n        this._displayPropList.push(id);\r\n        let prop = window['GameEnemysController'].getInactiveProp(id);\r\n        prop.node.position = position;\r\n        prop.display();\r\n    }\r\n\r\n    private _preDisplayGun = false;\r\n\r\n    onKillEnemy(enemy:Enemy){\r\n        if (GameProxy.killCount%10 == 0){\r\n            let position = enemy.node.position;\r\n            if (this._preDisplayGun){\r\n                this.displayProp(position);\r\n            }else {\r\n                this.displayGun(position);\r\n            }\r\n            this._preDisplayGun = !this._preDisplayGun;\r\n        }\r\n\r\n        if (GameProxy.killCount == GameProxy.levelConfig.amount_p1 - 3){\r\n            this.displayGun(enemy.node.position);\r\n        }\r\n\r\n        if (GameProxy.killCount + window['GameEnemysController'].allAliveEnemy().length < GameProxy.levelConfig.amount_p1){\r\n            //第一阶段\r\n            this._genEnemyCount += 2;\r\n            this.startCDTask();\r\n        }else if (GameProxy.enemyList.length > 0){\r\n            //第二阶段\r\n            this._genEnemyCount += 3;\r\n            this.startCDTask();\r\n        }else if (GameProxy.killCount >= GameProxy.maxEnemyNum) {\r\n            GameProxy.isOver = true;\r\n            GameProxy.pauseGame = true;\r\n            console.log(\"game win.\");\r\n            this.blockNode.active = true;\r\n        }\r\n        if (GameProxy.killCount == 5){\r\n            if (!World.My.newbies.state(\"KillFiveEnemy\")){\r\n                let newbieNode = new cc.Node();\r\n                newbieNode.name = \"newbieNode\";\r\n                newbieNode.position = this.supplyGuideNode.convertToWorldSpaceAR(cc.v2());\r\n                cc.director.getScene().addChild(newbieNode);\r\n                /** guideCircle */\r\n                let guideCirclePrefab = cc.loader.getRes(\"prefab/guideCircle\");\r\n                let guideCircleNode = cc.instantiate(guideCirclePrefab);\r\n                guideCircleNode.position = cc.v2();\r\n                newbieNode.addChild(guideCircleNode);\r\n                /** guideSke */\r\n                let guideSkePrefab = cc.loader.getRes(\"prefab/guideSke\");\r\n                let guideSkeNode = cc.instantiate(guideSkePrefab);\r\n                guideSkeNode.position = cc.v2();\r\n                newbieNode.addChild(guideSkeNode);\r\n                GameProxy.pauseGame = true;\r\n                this.greyNode.stopAllActions();\r\n                this.greyNode.opacity = 0;\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    genEnemy(){\r\n        if (GameProxy.enemyList.length <= 0){\r\n            return;\r\n        }\r\n        /** 判断上限 */\r\n        /** 第一阶段 */\r\n        let aliveCount = window['GameEnemysController'].allAliveEnemy().length;\r\n        if (GameProxy.killCount + aliveCount <= GameProxy.levelConfig.amount_p1){\r\n             if (aliveCount >= GameProxy.levelConfig.limit_p1){\r\n                 return;\r\n             }\r\n        }else {\r\n            if (aliveCount >= GameProxy.levelConfig.limit_p2){\r\n                return;\r\n            }\r\n        }\r\n        window['GameEnemysController'].createEnemy(GameProxy.enemyList.shift());\r\n        this._genEnemyCount--;\r\n        // window['GameEnemysController'].createEnemy(3);\r\n        if (GameProxy.maxEnemyNum - GameProxy.enemyList.length  === GameProxy.levelConfig.amount_p1+1){\r\n            this.moreEnemyTipsAnimation.node.opacity = 255;\r\n            this.moreEnemyTipsAnimation.node.active = true;\r\n            this.moreEnemyTipsAnimation.play();\r\n        }\r\n\r\n        if (GameProxy.enemyList.length == GameProxy.secondBossNum - 1){\r\n            this.bossTipsAnimation.node.opacity = 255;\r\n            this.bossTipsAnimation.node.active = true;\r\n            this.bossTipsAnimation.play();\r\n        }\r\n    }\r\n\r\n    update(dt:number){\r\n        if (this._genEnemyCount > 0){\r\n            this.genEnemy();\r\n        }\r\n    }\r\n}\r\n"]}