{"version":3,"sources":["assets/script/app/entities/prop/PropStateController.ts"],"names":[],"mappings":";;;;;AACA,mEAA8D;AAC9D,kDAA+C;AAEzC,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAAiD,uCAAY;IAA7D;QAAA,qEAuEC;QApEG,kBAAY,GAAqB,EAAE,CAAC;QAGpC,YAAM,GAAa,IAAI,CAAC;QAGxB,gBAAU,GAAkB,IAAI,CAAC;QAGjC,aAAO,GAAW,IAAI,CAAC;QAEvB,YAAM,GAAG,CAAC,CAAC;;IAyDf,CAAC;IAvDG,sCAAQ,GAAR;QACI,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;QAChC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;IACxC,CAAC;IAED,uCAAS,GAAT;QACI,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC;IAC/B,CAAC;IAED,kCAAI,GAAJ,UAAK,EAAS;QACV,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;QACjB,IAAI,gBAAgB,GAAG,CAAC,CAAC;QACzB,IAAI,EAAE,GAAG,CAAC,CAAC;QACX,QAAQ,EAAE,EAAC;YACP,KAAK,CAAC;gBACF,gBAAgB,GAAG,CAAC,CAAC;gBACrB,EAAE,GAAG,EAAE,CAAC;gBACR,MAAM;YACV,KAAK,CAAC;gBACF,gBAAgB,GAAG,CAAC,CAAC;gBACrB,EAAE,GAAG,EAAE,CAAC;gBACR,MAAM;YACV,KAAK,EAAE;gBACH,gBAAgB,GAAG,CAAC,CAAC;gBACrB,EAAE,GAAG,EAAE,CAAC;gBACR,MAAM;YACV,KAAK,EAAE;gBACH,gBAAgB,GAAG,CAAC,CAAC;gBACrB,EAAE,GAAG,EAAE,CAAC;gBACR,MAAM;YACV,KAAK,EAAE;gBACH,gBAAgB,GAAG,CAAC,CAAC;gBACrB,EAAE,GAAG,EAAE,CAAC;gBACR,MAAM;SACb;QACD,IAAI,CAAC,MAAM,CAAC,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,gBAAgB,CAAC,CAAC;QAC9D,IAAI,CAAC,OAAO,CAAC,EAAE,GAAG,EAAE,CAAC;QACrB,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC;QACrB,IAAI,CAAC,UAAU,CAAC,QAAQ,GAAG,CAAC,CAAC;QAC7B,IAAI,CAAC,OAAO,CAAC,KAAK,GAAG,IAAI,CAAC;QAC1B,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC;QACpB,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;QAC/B,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;IACvC,CAAC;IAED,6CAAe,GAAf,UAAgB,QAAe;QAC3B,IAAI,CAAC,UAAU,CAAC,QAAQ,GAAG,CAAC,GAAG,QAAQ,CAAC;IAC5C,CAAC;IAED,yCAAW,GAAX;QAAA,iBAKC;QAJG,qBAAS,CAAC,IAAI,CAAC,qBAAS,CAAC,KAAK,CAAC,UAAU,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;QACxD,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,QAAQ,CAAC,EAAE,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC,QAAQ,CAAC;YAC7D,KAAI,CAAC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;QAC7B,CAAC,CAAC,CAAC,CAAC,CAAC;IACT,CAAC;IAnED;QADC,QAAQ,CAAC,EAAE,CAAC,WAAW,CAAC;6DACW;IAGpC;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;uDACI;IAGxB;QADC,QAAQ,CAAC,EAAE,CAAC,WAAW,CAAC;2DACQ;IAGjC;QADC,QAAQ,CAAC,iBAAO,CAAC;wDACK;IAZN,mBAAmB;QADvC,OAAO;OACa,mBAAmB,CAuEvC;IAAD,0BAAC;CAvED,AAuEC,CAvEgD,EAAE,CAAC,SAAS,GAuE5D;kBAvEoB,mBAAmB","file":"","sourceRoot":"/","sourcesContent":["\r\nimport CDTimer from \"../../../../framework/component/CDTimer\";\r\nimport {GameProxy} from \"../../game/GameProxy\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class PropStateController extends cc.Component {\r\n\r\n    @property(cc.SpriteFrame)\r\n    spriteFrames: [cc.SpriteFrame] = [];\r\n\r\n    @property(cc.Sprite)\r\n    sprite:cc.Sprite = null;\r\n\r\n    @property(cc.ProgressBar)\r\n    prgressBar:cc.ProgressBar = null;\r\n\r\n    @property(CDTimer)\r\n    cdTimer:CDTimer = null;\r\n\r\n    propID = 0;\r\n\r\n    onEnable(){\r\n        this.sprite.node.active = false;\r\n        this.prgressBar.node.active = false;\r\n    }\r\n\r\n    onDisable(){\r\n        this.node.stopAllActions();\r\n    }\r\n\r\n    init(id:number){\r\n        this.propID = id;\r\n        let spriteFrameIndex = 0;\r\n        let cd = 0;\r\n        switch (id){\r\n            case 5:\r\n                spriteFrameIndex = 0;\r\n                cd = 15;\r\n                break;\r\n            case 9:\r\n                spriteFrameIndex = 1;\r\n                cd = 12;\r\n                break;\r\n            case 10:\r\n                spriteFrameIndex = 2;\r\n                cd = 12;\r\n                break;\r\n            case 12:\r\n                spriteFrameIndex = 3;\r\n                cd = 20;\r\n                break;\r\n            case 13:\r\n                spriteFrameIndex = 4;\r\n                cd = 10;\r\n                break;\r\n        }\r\n        this.sprite.spriteFrame = this.spriteFrames[spriteFrameIndex];\r\n        this.cdTimer.cd = cd;\r\n        this.cdTimer.reset();\r\n        this.prgressBar.progress = 1;\r\n        this.cdTimer.pause = true;\r\n        this.node.scale = 1;\r\n        this.sprite.node.active = true;\r\n        this.prgressBar.node.active = true;\r\n    }\r\n\r\n    onProgressEvent(progress:number){\r\n        this.prgressBar.progress = 1 - progress;\r\n    }\r\n\r\n    onZeroEvent(){\r\n        GameProxy.emit(GameProxy.Event.PropCDZero, this.propID);\r\n        this.node.runAction(cc.sequence(cc.scaleTo(0.15, 0), cc.callFunc(()=>{\r\n            this.node.active = false;\r\n        })));\r\n    }\r\n}\r\n"]}