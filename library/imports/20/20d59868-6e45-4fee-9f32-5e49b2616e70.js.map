{"version":3,"sources":["assets/script/app/entities/bulletEmitter/BulletEmitter.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import GameBulletsController from \"../../game/GameBulletsController\";\r\nimport {ExcelTableNames} from \"../../config/ExcelTableNames\";\r\nimport {ExcelConfig} from \"../../../../framework/config/ExcelConfig\";\r\nimport {GameProxy} from \"../../game/GameProxy\";\r\nimport {World} from \"../../info/World\";\r\n\r\n/**\r\n * 子弹发射器只负责发射子弹\r\n * 控制一次发射的子弹个数及每一颗子弹的发射\r\n */\r\n\r\n\r\nexport default abstract class BulletEmitter {\r\n\r\n    static TYPES = {\r\n        ShouQiang : 1,\r\n        PenZi : 2,\r\n        JiaTeLin : 3,\r\n        SanDanQiang : 4,\r\n        HuoYan : 5,\r\n        JiGuang : 6,\r\n        JuJiQiang : 7,\r\n        LiZiPao : 8,\r\n        HuoJianTong : 9,\r\n        ShanDianQiu : 10,\r\n    };\r\n\r\n    protected constructor(gameBulletsController:GameBulletsController){\r\n        this._gameBulletsController = gameBulletsController;\r\n    }\r\n    private _gameBulletsController:GameBulletsController = null;\r\n\r\n\r\n    /** 射程 */\r\n    protected _firingRange = 0;\r\n\r\n    get firingRange(): number {\r\n        return this._firingRange;\r\n    }\r\n\r\n    /** 发射间隔 */\r\n    protected _interval = 0;\r\n\r\n\r\n    get interval(): number {\r\n        return this._interval;\r\n    }\r\n\r\n    /** 子弹的速度 */\r\n    protected _speed = 0;\r\n\r\n\r\n    get speed(): number {\r\n        return this._speed;\r\n    }\r\n\r\n    /** 弹容量 */\r\n    private _payload = 0;\r\n\r\n    get payload(): number {\r\n        return this._payload;\r\n    }\r\n\r\n    set payload(value: number) {\r\n        this._payload = value;\r\n        this.bulletCount = this._payload;\r\n    }\r\n\r\n    /** 剩余弹量 */\r\n    private _bulletCount = 0;\r\n\r\n\r\n    get bulletCount(): number {\r\n        return this._bulletCount;\r\n    }\r\n\r\n\r\n    set bulletCount(value: number) {\r\n        this._bulletCount = value;\r\n        GameProxy.emit(GameProxy.Event.UpdateBulletCount);\r\n    }\r\n\r\n    /** 是否子弹用尽 */\r\n    isUseUp(){\r\n        return this._payload != 0 && this._bulletCount < 1;\r\n    }\r\n\r\n    get gameBulletsController(): GameBulletsController {\r\n        return this._gameBulletsController;\r\n    }\r\n\r\n\r\n    protected _bulletEmitterID = 0;\r\n\r\n    init(id:number){\r\n        this._bulletEmitterID = id;\r\n        let config = ExcelConfig.getExcelTable(ExcelTableNames.Weapon)[this._bulletEmitterID-1];\r\n        this._speed = config['speed'];\r\n        this._firingRange = config['range']*World.My.armory.rangeMulOf(this._bulletEmitterID);\r\n        this._interval = config['fre']*World.My.armory.freMulOf(this._bulletEmitterID);\r\n        this.payload = World.My.armory.payloadAddOf(this._bulletEmitterID);\r\n        console.log('payload===>', this._payload);\r\n    }\r\n\r\n    abstract fire(start: cc.Vec2, dir: cc.Vec2);\r\n\r\n    onEnter(){}\r\n    onExit(){}\r\n}\r\n\r\n"]}