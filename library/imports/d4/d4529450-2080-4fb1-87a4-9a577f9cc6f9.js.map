{"version":3,"sources":["assets/script/app/info/Armory.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\nimport {World} from \"./World\";\r\nimport {ExcelConfig} from \"../../../framework/config/ExcelConfig\";\r\nimport {ExcelTableNames} from \"../config/ExcelTableNames\";\r\n\r\nconst EMITTER_POWER_LEVEL = \"powerLv\";\r\nconst EMITTER_FIRE_POWER_LEVEL = \"firePowerLv\";\r\n\r\n// const POWER_MULS = [1,2,2,4,2,4,6,6,6,6,6];\r\nconst PAYLOAD_MULS = [1,1,10,2,5,10,1,1,1,1,1];\r\n\r\n/** 试用加50级 */\r\nconst TRIAL_ADD = 50;\r\n\r\n/** 武器库 */\r\nexport default class Armory {\r\n\r\n    constructor(map){\r\n        this._map = map;\r\n        this._weaponUpCfg = ExcelConfig.getExcelTable(ExcelTableNames.WeaponUp);\r\n        this._bulletUpCfg = ExcelConfig.getExcelTable(ExcelTableNames.BulletUp);\r\n    }\r\n\r\n    private _map:[number, number] = null;\r\n    private _weaponUpCfg:any = null;\r\n    private _bulletUpCfg:any = null;\r\n\r\n\r\n    /** 伤害加成 */\r\n    hurtMulOf(emitter:number){\r\n        let baseMul = this._weaponUpCfg[World.Storage.ADLv-1]['fight'];\r\n        if (emitter == 1){\r\n            return baseMul;\r\n        }\r\n        let lv = this.levelOfEmitterPower(emitter);\r\n        if (emitter == World.Storage.unlockGun){\r\n            lv += TRIAL_ADD;\r\n            if (lv > this._weaponUpCfg.length){\r\n                lv = this._weaponUpCfg.length;\r\n            }\r\n        }\r\n        return this._weaponUpCfg[lv-1]['hurt_add'] * baseMul;\r\n    }\r\n\r\n    /** 弹容量累加 */\r\n    payloadAddOf(emitter:number){\r\n        if (emitter == 1)return 0;\r\n        let lv = this.levelOfEmitterFirePower(emitter);\r\n        if (emitter == World.Storage.unlockGun){\r\n            lv += TRIAL_ADD;\r\n            if (lv > this._weaponUpCfg.length){\r\n                lv = this._weaponUpCfg.length;\r\n            }\r\n        }\r\n        return this._bulletUpCfg[lv-1][\"gun_\"+(\"000\"+emitter).substr(-3)];\r\n    }\r\n\r\n    /** 发射频率加成 */\r\n    freMulOf(emitter:number){\r\n        let index = 0;\r\n        if (emitter == 1){\r\n            index = World.Storage.ADLv-1;\r\n        }else {\r\n            let lv = this.levelOfEmitterFirePower(emitter);\r\n            if (emitter == World.Storage.unlockGun){\r\n                lv += TRIAL_ADD;\r\n                if (lv > this._weaponUpCfg.length){\r\n                    lv = this._weaponUpCfg.length;\r\n                }\r\n            }\r\n            index = lv - 1;\r\n        }\r\n        return this._weaponUpCfg[index]['fre'];\r\n    }\r\n\r\n    /** 射程加成 */\r\n    rangeMulOf(emitter:number){\r\n        if (emitter == 4 || emitter == 5){\r\n            let lv = this.levelOfEmitterPower(emitter);\r\n            if (emitter == World.Storage.unlockGun){\r\n                lv += TRIAL_ADD;\r\n                if (lv > this._weaponUpCfg.length){\r\n                    lv = this._weaponUpCfg.length;\r\n                }\r\n            }\r\n            return this._weaponUpCfg[lv - 1]['range_add'];\r\n        }else {\r\n            return 1;\r\n        }\r\n    }\r\n\r\n    /** 放大加成 */\r\n    magnifyMul(emitter:number){\r\n        if (emitter == 2 || emitter == 9 || emitter == 10){\r\n            let lv = this.levelOfEmitterPower(emitter);\r\n            if (emitter == World.Storage.unlockGun){\r\n                lv += TRIAL_ADD;\r\n                if (lv > this._weaponUpCfg.length){\r\n                    lv = this._weaponUpCfg.length;\r\n                }\r\n            }\r\n            return this._weaponUpCfg[lv - 1]['amp_add'];\r\n        } else {\r\n            return 1;\r\n        }\r\n    }\r\n\r\n\r\n    /** 获取武器的威力加成 */\r\n    levelOfEmitterPower(emitter:number){\r\n        let data = this._map[emitter];\r\n        if (data){\r\n            return data[EMITTER_POWER_LEVEL];\r\n        }else {\r\n            return 1;\r\n        }\r\n    }\r\n\r\n    \r\n\r\n    /** 获取武器的火力加成 */\r\n    levelOfEmitterFirePower(emitter:number){\r\n        let data = this._map[emitter];\r\n        if (data){\r\n            return data[EMITTER_FIRE_POWER_LEVEL];\r\n        }else {\r\n            return 1;\r\n        }\r\n    }\r\n\r\n    addLevelOfEmitterPower(emitter:number, add:number){\r\n        let data = this._map[emitter];\r\n        if (!data){\r\n            data = {};\r\n            data[EMITTER_POWER_LEVEL] = 1;\r\n            data[EMITTER_FIRE_POWER_LEVEL] = 1;\r\n            this._map[emitter] = data;\r\n        }\r\n        data[EMITTER_POWER_LEVEL] = data[EMITTER_POWER_LEVEL]+add;\r\n        World.Storage.armory = this.toJson();\r\n    }\r\n\r\n    addLevelOfEmitterFirePower(emitter:number, add:number){\r\n        let data = this._map[emitter];\r\n        if (!data){\r\n            data = {};\r\n            data[EMITTER_POWER_LEVEL] = 1;\r\n            data[EMITTER_FIRE_POWER_LEVEL] = 1;\r\n            this._map[emitter] = data;\r\n        }\r\n        data[EMITTER_FIRE_POWER_LEVEL] = data[EMITTER_FIRE_POWER_LEVEL] + add;\r\n        World.Storage.armory = this.toJson();\r\n    }\r\n\r\n    toJson(){\r\n        return JSON.stringify(this._map);\r\n    }\r\n}\r\n"]}