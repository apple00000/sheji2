{"version":3,"sources":["assets/script/app/entities/prop/PropBase.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\n\r\nimport {GameProxy} from \"../../game/GameProxy\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class PropBase extends cc.Component {\r\n\r\n    // @property\r\n    cd = 12;\r\n\r\n    collider:cc.Collider = null;\r\n\r\n    /** 是否触发了 */\r\n    protected _on_off = false;\r\n\r\n    /** 是否被磁铁吸引 */\r\n    private _magnetic = false;\r\n\r\n    get on_off(): boolean {\r\n        return this._on_off;\r\n    }\r\n\r\n\r\n    get magnetic(): boolean {\r\n        return this._magnetic;\r\n    }\r\n\r\n    set magnetic(value: boolean) {\r\n        if (value != this._magnetic){\r\n            this._magnetic = value;\r\n            if (this._magnetic){\r\n                // console.log(\"磁力生效===>\");\r\n                this.node.stopAllActions();\r\n                /** 撞向角色 */\r\n                this.moveToRole();\r\n            }\r\n        }\r\n    }\r\n\r\n    private moveToRole(){\r\n        let gameRoleController = window['GameRoleController'];\r\n        let speed = 1000;\r\n        let distance = this.node.position.sub(gameRoleController.role.node.position).mag();\r\n        this.node.runAction(cc.sequence(cc.moveTo(distance/speed, gameRoleController.role.node.position).easing(cc.easeSineIn()), cc.callFunc(()=>{\r\n            this.moveToRole();\r\n        })));\r\n    }\r\n\r\n    propID = -1;\r\n\r\n    init(id:number){\r\n        this.propID = id;\r\n    }\r\n\r\n    display(){\r\n        this._on_off = false;\r\n        this.node.active = true;\r\n        //倒计时\r\n        if (this.cd > 0){\r\n            this.node.runAction(cc.sequence(cc.delayTime(this.cd-5), cc.blink(5, 25), cc.callFunc(()=>{\r\n                this.node.active = false;\r\n            })));\r\n        }\r\n    }\r\n\r\n    trigger(){\r\n        this._on_off = true;\r\n        this.node.stopAllActions();\r\n        GameProxy.emit(GameProxy.Event.PropTrigger, this);\r\n        this.node.active = false;\r\n    }\r\n\r\n    onLoad(){\r\n        this.collider = this.getComponent(cc.Collider);\r\n    }\r\n\r\n\r\n    onEnable(){\r\n        /** 检测与角色的碰撞 */\r\n        this._on_off = false;\r\n        this._magnetic = false;\r\n        window['GameEnemysController'].gameProps.push(this);\r\n    }\r\n\r\n    onDisable(){\r\n        this.node.stopAllActions();\r\n        let gameEnemysController = window['GameEnemysController'];\r\n        gameEnemysController.gameProps.splice(gameEnemysController.gameProps.indexOf(this), 1);\r\n    }\r\n}\r\n"]}